(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{10:function(e,t,n){e.exports={ingredients:"burger-ingredients_ingredients__3ElkJ",menu:"burger-ingredients_menu__1AGSy",navigation:"burger-ingredients_navigation__2fOQ5",navLink:"burger-ingredients_navLink__EFZ70",navLinkActive:"burger-ingredients_navLinkActive__1Jxpi burger-ingredients_navLink__EFZ70",sections:"burger-ingredients_sections__WEVwA",sectionFood:"burger-ingredients_sectionFood__2yBV9",cards:"burger-ingredients_cards__1_ztt",card:"burger-ingredients_card__2orry",cardPrice:"burger-ingredients_cardPrice__1i_8M",cardTitle:"burger-ingredients_cardTitle__3obuH",count:"burger-ingredients_count__3NHUR",cardText:"burger-ingredients_cardText__2go2e",cardImage:"burger-ingredients_cardImage__1pVfE"}},103:function(e,t,n){e.exports={overlay:"modal-overlay_overlay__21jg3"}},104:function(e,t,n){e.exports={burgers:"feed-burgers_burgers__KapyN",cards:"feed-burgers_cards__xs5Q_"}},117:function(e,t,n){},196:function(e,t,n){"use strict";n.r(t),n.d(t,"store",(function(){return Rn}));var r=n(1),c=n.n(r),a=n(36),o=n.n(a),i=(n(117),n(25)),s=i.d,u=function(){return Object(i.c)()},l=n(9),d=n(99),j=n.n(d),f=n(3),b=n(111),p=n(0),m=["children"],x=function(e){var t=e.children,n=Object(b.a)(e,m),r=s((function(e){return e.profile.user.isAuth}));return Object(p.jsx)(l.b,Object(f.a)(Object(f.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(p.jsx)(l.a,{to:{pathname:"/login",state:{from:n}}})}}))},h=n(32),O=n.n(h),g=n(4),_=n(7),y=c.a.memo((function(e){var t=e.data,n=t.icon,r=t.text,c=t.link,a=t.type,o={burger:g.BurgerIcon,list:g.ListIcon,profile:g.ProfileIcon}[n];return Object(p.jsx)(_.b,{to:c,children:Object(p.jsxs)("button",{className:O.a["button-"+a],children:[Object(p.jsx)(o,{type:a}),Object(p.jsx)("p",{className:"text text_type_main-small pl-1",children:r})]})})})),v=c.a.memo((function(){var e=s((function(e){return e.header})),t=u(),n=Object(l.h)().pathname;return Object(r.useEffect)((function(){var r=0,c="";for(var a in e){var o=e[a].link;n.includes(o)&&o.length>r&&(c=a,r=o.length),"/"===o&&"/"!==n&&(c="")}t({type:"header/onChangeLink",payload:c})}),[n]),Object(p.jsx)("header",{className:O.a.header,children:Object(p.jsxs)("nav",{className:O.a.content+" pt-4 pb-4",children:[Object(p.jsxs)("div",{className:O.a.menu,children:[Object(p.jsx)(y,{data:e.burger}),Object(p.jsx)(y,{data:e.orders})]}),Object(p.jsx)(y,{data:e.profile}),Object(p.jsx)("div",{className:O.a.logo,children:Object(p.jsx)(_.b,{to:"/",children:Object(p.jsx)(g.Logo,{})})})]})})})),N=n(8),I=n(26),w=n.n(I),k=n(44),E=function(e,t){return Math.floor(e+Math.random()*(t+1-e))};function C(e){var t=e.find((function(e){return"bun"===e.type})),n=e.filter((function(e){return"bun"!==e.type})).map((function(e,t){return Object(f.a)(Object(f.a)({},e),{},{unicId:t+e._id})})),r=n.reduce((function(e,t){return e+t.price}),0)+(t?2*t.price:0);return{recipe:e=n.concat(t||[]),bun:t,filling:n,totalPrice:r}}function S(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function L(e,t,n){var r=(n=n||{}).expires;if("number"==typeof r&&r){var c=new Date;c.setTime(c.getTime()+1e3*r),r=n.expires=c}r&&r.toUTCString&&(n.expires=r.toUTCString());var a=e+"="+(t=encodeURIComponent(null!==t?t:""));for(var o in n){a+="; "+o;var i=n[o];!0!==i&&(a+="="+i)}document.cookie=a}var T="https://norma.nomoreparties.space/api",P=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))},F=function(){var e=localStorage.getItem("refreshToken");return fetch("".concat(T,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:e},body:JSON.stringify({token:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))})).then((function(e){return localStorage.setItem("refreshToken",e.refreshToken),L("accessToken",e.accessToken.split("Bearer ")[1]),e}))},B={bun:"\u0411\u0443\u043b\u043a\u0438",main:"\u041d\u0430\u0447\u0438\u043d\u043a\u0430",sauce:"\u0421\u043e\u0443\u0441\u044b"},D=Object(N.b)({name:"foods",initialState:{items:[],sections:[],isLoading:!1,isError:!1,isLoaded:!1},reducers:{foodsLoading:function(e){e.isLoading=!0,e.isError=!1,e.isLoaded=!1},foodsError:function(e){e.isLoading=!1,e.isError=!0,e.isLoaded=!1},foodsSuccess:function(e,t){e.items=t.payload,e.isLoading=!1,e.isError=!1,e.isLoaded=!0,e.sections=function(e){var t=[];return e.forEach((function(e){var n=t.findIndex((function(t){return t.id===e.type}));n>-1?t[n].foods.push(Object(f.a)(Object(f.a)({},e),{},{count:0})):t.push({id:e.type,text:B[e.type],foods:[Object(f.a)(Object(f.a)({},e),{},{count:0})],active:!1})})),t}(t.payload)},clearCounts:function(e){e.sections.forEach((function(e){e.foods=e.foods.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{count:0})}))}))},setCounts:function(e,t){e.sections.forEach((function(e){return e.foods.forEach((function(e){return e.count=t.payload.reduce((function(t,n){return n._id===e._id?t+("bun"!==n.type?1:2):t}),0)}))}))},setActiveSection:function(e,t){e.sections=e.sections.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{active:e.id===t.payload})}))}}}),A=D.actions,H=D.reducer,R=A.foodsLoading,M=A.foodsError,z=A.foodsSuccess,J=(A.clearCounts,A.setCounts,A.setActiveSection),U=function(){return function(e){return e(R()),fetch("".concat(T,"/ingredients")).then((function(e){return P(e)})).then((function(t){return e(z(t.data))})).catch((function(t){return console.log("Error with ingredients:",t),e(M())}))}},G=function(e,t){e({type:"foods/setCounts",payload:t().burger.recipe})};var V=n(20),Q=n.n(V),Y=n(10),W=n.n(Y),Z=c.a.memo((function(e){var t=e.sections,n=u();return Object(p.jsxs)("div",{className:W.a.menu,children:[Object(p.jsx)("h1",{className:"text text_type_main-large mb-5",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(p.jsx)("nav",{className:W.a.navigation,children:t.map((function(e){return Object(p.jsx)("a",{href:"#".concat(e.id),className:(e.active?W.a.navLinkActive:W.a.navLink)+" pt-4 pb-4 text text_type_main-default",onClick:function(){return n(J(e.id))},children:e.text},e.id)}))})]})})),q=n(12),K=n(202),X=c.a.memo((function(e){var t=e.food,n=u(),r=Object(l.h)(),c=Object(K.a)({type:"food",item:t}),a=Object(q.a)(c,2)[1];return Object(p.jsx)(_.b,{to:{pathname:"/ingredients/".concat(t._id),state:{background:r}},children:Object(p.jsxs)("li",{className:W.a.card,onClick:function(){return n({type:"ingredient/openIngredient",payload:t})},children:[Object(p.jsx)("img",{className:W.a.cardImage,src:t.image,alt:t.name,ref:a}),Object(p.jsxs)("div",{className:W.a.cardText,children:[Object(p.jsxs)("div",{className:W.a.cardPrice,children:[Object(p.jsx)("span",{className:"text text_type_main-medium m-2",style:{lineHeight:"1"},children:t.price}),Object(p.jsx)(g.CurrencyIcon,{type:"primary"})]}),Object(p.jsx)("h3",{className:W.a.cardTitle+" text text_type_main-default",children:t.name})]}),Object(p.jsx)("div",{className:W.a.count,children:!!t.count&&Object(p.jsx)(g.Counter,{count:t.count,size:"default"})})]})})})),$=c.a.memo((function(e){var t=e.sections,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(null!==n&&null!==n.current){var e=n.current.offsetHeight,t=0,r=n.current.closest("#ingredients");null!==r&&(t=r.clientHeight),t>e&&(n.current.style.paddingBottom=t-e+"px")}}),[t]),Object(p.jsx)("ul",{className:W.a.sections,children:t.map((function(e,r){return Object(p.jsxs)("li",{className:W.a.sectionFood,id:e.id,ref:r===t.length-1?n:void 0,children:[Object(p.jsx)("h2",{className:"text text_type_main-medium",children:e.text}),Object(p.jsx)("ul",{className:W.a.cards,children:e.foods.map((function(e){return Object(p.jsx)(X,{food:e},e._id)}))})]},e.id)}))})})),ee=n(48),te=n.n(ee),ne=c.a.memo((function(e){var t=Object(r.useState)(""),n=Object(q.a)(t,2),c=n[0],a=n[1],o=Object(r.useRef)(null),i=Object(r.useRef)(null),s=Object(r.useRef)(null),u=Object(r.useRef)(null);Object(r.useEffect)((function(){var t=o.current,n=i.current,r=s.current,c=u.current;t.style.paddingBottom=e.bottom?String(e.bottom)+"px":"0px",r.style.top=e.top?String(e.top)+"px":"0px",r.style.bottom=e.bottom?e.bottom+"px":"0px",c.style.height=String(r.clientHeight*n.clientHeight/n.scrollHeight)+"px";var d=function(){n.scrollHeight>n.clientHeight?(r.style.visibility="visible",c.style.top=r.clientHeight*n.scrollTop/n.scrollHeight+"px",e.arrBlocksId&&a(l())):r.style.visibility="hidden"};d(),n.addEventListener("scroll",d),c.addEventListener("mousedown",(function(e){e.preventDefault(),n.style.scrollBehavior="auto";var t=c.offsetTop,a=function(a){var o=a.pageY-e.pageY,i=Math.min(r.clientHeight-c.clientHeight,Math.max(0,t+o))/r.clientHeight;n.scrollTop=n.scrollHeight*i};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e),n.style.scrollBehavior="smooth"}))}))}),[e]),Object(r.useEffect)((function(){c&&e.callbackScroll&&e.callbackScroll(c)}),[c,e]);var l=Object(r.useCallback)((function(){var t,n=o.current,r=n.getBoundingClientRect().top,c=n.clientHeight+r,a=0;return e.arrBlocksId&&e.arrBlocksId.forEach((function(e){var n=document.querySelector("#".concat(e));if(n){var o=n.getBoundingClientRect().top,i=n.clientHeight+o,s=r>o?r-o:0,u=c<i?i-c:0,l=(n.clientHeight-s-u)/n.clientHeight;l>a&&(a=l,t=e)}})),t}),[e]);return Object(p.jsxs)("section",{className:te.a.container,id:e.id?e.id:"scrollbox",ref:o,children:[Object(p.jsx)("div",{className:te.a.scrollBarContainer,ref:s,children:Object(p.jsx)("div",{className:te.a.scrollbar,ref:u})}),Object(p.jsx)("div",{className:te.a.content,ref:i,children:e.children})]})})),re=function(){var e=s((function(e){return e.foods.sections})),t=u(),n=Object(r.useCallback)((function(n){var r=e.find((function(e){return e.active}));r&&r.id===n||t(J(n))}),[e,t]);return Object(p.jsx)("article",{className:W.a.ingredients,children:!!e.length&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(Z,{sections:e}),Object(p.jsx)(ne,{top:40,bottom:16,id:"ingredients",arrBlocksId:e.map((function(e){return e.id})),callbackScroll:n,children:Object(p.jsx)($,{sections:e})})]})})},ce=n(22),ae=n.n(ce),oe=n(203),ie=function(e){var t=e.id,n=e.children,c=e.index,a=e.moveElement,o=Object(r.useRef)(null),i=Object(oe.a)({accept:"card",collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){var n;if(o.current){var r=e.index,i=c;if(r!==i){var s=null===(n=o.current)||void 0===n?void 0:n.getBoundingClientRect(),u=(s.bottom-s.top)/2,l=t.getClientOffset().y-s.top;r<i&&l<u||r>i&&l>u||(a(r,i),e.index=i)}}}}),s=Object(q.a)(i,2),u=s[0].handlerId,l=s[1],d=Object(K.a)({type:"card",item:function(){return{id:t,index:c}},collect:function(e){return{isDragging:e.isDragging()}}}),j=Object(q.a)(d,2),b=j[0].isDragging?0:1;return(0,j[1])(l(o)),Object(p.jsx)("div",{ref:o,"data-handler-id":u,style:Object(f.a)(Object(f.a)({},{padding:"0",margin:"0",backgroundColor:"transparent",cursor:"pointer"}),{},{opacity:b}),children:n})},se=n(102),ue=n.n(se),le=n(38),de={recipe:[],totalPrice:null,bun:null,filling:[]},je=Object(N.b)({name:"burger",initialState:de,reducers:{clear:function(e){return de},random:function(e,t){return C(function(e){for(var t=[],n=E(6,10),r=0;r<n;r++)t[r]=e[E(0,e.length-1)];if(!t.find((function(e){return"bun"===e.type}))){var c=e.find((function(e){return"bun"===e.type}));"undefined"!==typeof c&&t.push(c)}return t}(t.payload))},del:function(e,t){var n=e.filling.filter((function(e){return e.unicId!==t.payload}));return e.bun&&n.push(e.bun),C(n)},add:function(e,t){var n=Object(f.a)({},t.payload),r=Object(le.a)(e.recipe);return"bun"===n.type&&e.bun?r.splice(r.findIndex((function(e){return"bun"===e.type})),1,n):r.push(n),C(r)},sort:function(e,t){var n=t.payload;e.filling=n}}}),fe=function(e){return function(){var t=Object(k.a)(w.a.mark((function t(n,r){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({type:"burger/add",payload:e});case 2:G(n,r);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},be=je.actions,pe=je.reducer,me=(be.clear,be.random,be.del,be.add,c.a.memo((function(){var e=s((function(e){return e.burger.filling})),t=u(),n=Object(r.useCallback)((function(n,r){var c=e[n];t({type:"burger/sort",payload:ue()(e,{$splice:[[n,1],[r,0,c]]})})}),[e,t]);return Object(p.jsx)("div",{className:ae.a.filling,id:"filling",children:Object(p.jsx)(ne,{top:40,id:"burgers",children:Object(p.jsx)("div",{className:ae.a.recipe,children:e.map((function(e,r){return Object(p.jsxs)(ie,{index:r,id:e.unicId,moveElement:n,children:[Object(p.jsx)(g.DragIcon,{type:"primary"}),Object(p.jsx)(g.ConstructorElement,{text:e.name,price:e.price,thumbnail:e.image,handleClose:function(){return t((n=e,function(e,t){e({type:"burger/del",payload:n.unicId}),G(e,t)}));var n}})]},e.unicId)}))})})})}))),xe=Object(N.b)({name:"orders",initialState:{items:[],isLoading:!1,isError:!1,openDetails:!1,currentNumber:null},reducers:{closeDetails:function(e){e.openDetails=!1,e.currentNumber=null},orderLoading:function(e){e.openDetails=!0,e.isLoading=!0,e.isError=!1},orderError:function(e){e.isLoading=!1,e.isError=!0},orderSuccess:function(e,t){e.items=[].concat(Object(le.a)(e.items),[t.payload]),e.currentNumber=t.payload.number,e.isLoading=!1,e.isError=!1}}}),he=xe.actions,Oe=xe.reducer,ge=he.orderLoading,_e=he.orderError,ye=he.orderSuccess;he.closeDetails;function ve(e){return function(t,n){t(ge());var r,c=n().burger,a=c.totalPrice,o=c.recipe;(r=e,fetch("".concat(T,"/orders"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+S("accessToken")},body:JSON.stringify({ingredients:r})}).then((function(e){return P(e)}))).then((function(e){return t(ye(Object(f.a)(Object(f.a)({},e),{},{number:e.order.number,totalPrice:a,recipe:o})))})).catch((function(e){console.log("Error with order:",e),t(_e())}))}}var Ne=function(){var e=u(),t=Object(l.g)(),n=s((function(e){return e.burger})),c=s((function(e){return e.profile.user.isAuth}));Object(r.useEffect)((function(){!function(){var e=document.querySelector("#orderPrice"),t=null!==e?e.querySelector("svg"):null,n=null!==e?getComputedStyle(e).fontSize:"16px";null!==t&&(t.setAttribute("width",n),t.setAttribute("height",n))}()}),[]);var a=Object(r.useCallback)((function(){c?e(ve(n.recipe.map((function(e){return e._id})))):t.push("/login")}),[e,n.recipe]);return Object(p.jsxs)("div",{className:ae.a.confirm,children:[Object(p.jsxs)("div",{className:ae.a.orderPrice+" text text_type_main-large",id:"orderPrice",children:[Object(p.jsx)("span",{className:"m-3",style:{lineHeight:"1"},children:n.totalPrice}),Object(p.jsx)(g.CurrencyIcon,{type:"primary"})]}),Object(p.jsx)(g.Button,{type:"primary",size:"large",onClick:a,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})},Ie=function(){var e=u();return Object(p.jsxs)("div",{className:ae.a.menu,children:[Object(p.jsx)(g.Button,{type:"primary",size:"small",onClick:function(){return e(function(){var e=Object(k.a)(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n().foods.items,e.next=3,t({type:"burger/random",payload:r});case 3:G(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},children:"\u0420\u0435\u0446\u0435\u043f\u0442 \u043e\u0442 \u043d\u0430\u0448\u0435\u0433\u043e \u0440\u043e\u0431\u043e\u0442\u0430"}),Object(p.jsx)(g.Button,{type:"primary",size:"small",onClick:function(){return e((function(e){e({type:"burger/clear"}),e({type:"foods/clearCounts"})}))},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0440\u0435\u0446\u0435\u043f\u0442"})]})},we=n(57),ke=n.n(we),Ee=n(103),Ce=n.n(Ee),Se=function(e){return Object(p.jsx)("div",{className:Ce.a.overlay,onClick:e.onClose,children:e.children})},Le=document.getElementById("modal"),Te=c.a.memo((function(e){var t=e.children,n=e.isLoading,c=e.onClose,a=e.title;Object(r.useEffect)((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[n]);var i=function(e){"Escape"!==e.key||n||c()};return o.a.createPortal(Object(p.jsx)(Se,{onClose:n?null:c,children:Object(p.jsxs)("div",{className:ke.a.modalBox,onClick:function(e){return e.stopPropagation()},children:[!n&&Object(p.jsx)("button",{className:ke.a.closePosition,children:Object(p.jsx)(g.CloseIcon,{onClick:c,type:"primary"})}),a&&Object(p.jsx)("p",{className:"text text_type_main-large",children:a}),Object(p.jsx)("div",{className:ke.a.content,children:t})]})}),Le)})),Pe=n(39),Fe=n.n(Pe),Be=n.p+"static/media/icon-done.e036971b.png",De=function(){var e=function(){return E(1e3,9999)},t=Object(r.useState)(e),n=Object(q.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){var t=setInterval((function(){return a(e)}),50);return function(){clearInterval(t)}}),[]),Object(p.jsx)("h1",{className:Fe.a.titleLoader+" text text_type_digits-large",children:c})},Ae=n(58),He=n.n(Ae),Re=c.a.memo((function(e){var t=e.text,n=void 0===t?"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c...":t,r=[1,2,3,4,5];return Object(p.jsxs)("div",{className:He.a.container,children:[Object(p.jsx)("div",{className:He.a.icons,children:r.map((function(e){return Object(p.jsx)("div",{className:He.a.icon,style:{top:70*Math.sin(2*e*Math.PI/r.length)+"px",left:70*Math.cos(2*e*Math.PI/r.length)+"px"},children:Object(p.jsx)(g.BurgerIcon,{type:"primary"})},e+"loader")}))}),Object(p.jsx)("p",{className:"text text_type_main-medium",children:n})]})})),Me=n(79),ze=n.n(Me),Je=c.a.memo((function(e){var t=e.textArr,n=t||["\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a.","\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."];return Object(p.jsxs)("div",{className:ze.a.container,children:[Object(p.jsxs)("div",{className:ze.a.icons,children:[Object(p.jsx)(g.BurgerIcon,{type:"error"}),Object(p.jsx)(g.BurgerIcon,{type:"error"}),Object(p.jsx)(g.BurgerIcon,{type:"error"})]}),n.map((function(e,t){return Object(p.jsx)("p",{className:"text text_type_main-medium m-4",children:e},t+e)}))]})})),Ue=c.a.memo((function(e){var t=e.orders;return Object(p.jsx)("div",{className:Fe.a.container,children:t.isError?Object(p.jsx)(Je,{textArr:["\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u0437\u0430\u043a\u0430\u0437 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u043d\u044f\u0442\u044c","\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0435\u0433\u043e \u0435\u0449\u0435 \u0440\u0430\u0437"]}):Object(p.jsxs)(p.Fragment,{children:[t.isLoading?Object(p.jsx)(De,{}):Object(p.jsx)("h1",{className:Fe.a.title+" text text_type_digits-large",children:t.currentNumber}),Object(p.jsx)("p",{className:"text text_type_main-medium",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),t.isLoading?Object(p.jsx)(Re,{text:""}):Object(p.jsx)("img",{className:Fe.a.icon,src:Be,alt:"icon_done"}),Object(p.jsx)("p",{className:"text text_type_main-default mb-2",children:t.isLoading?"\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u044e":"\u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(p.jsx)("span",{className:"text text_type_main-default text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})})})),Ge=function(){var e=s((function(e){return e.burger})),t=s((function(e){return e.orders})),n=u(),r=Object(oe.a)({accept:"food",drop:function(e){return function(e){n(fe(e))}(e)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),c=Object(q.a)(r,2),a=c[0],o=a.canDrop,i=a.isOver,l=c[1];return Object(p.jsxs)("article",{className:ae.a.main,children:[Object(p.jsx)(Ie,{}),Object(p.jsxs)("div",{className:ae.a.dropContainer,id:"dropContainer",ref:l,drop:String(i&&o),drag:String(!i&&o),children:[!!e.bun&&Object(p.jsx)(g.ConstructorElement,{type:"top",isLocked:!0,text:e.bun.name+" (\u0432\u0435\u0440\u0445)",price:e.bun.price,thumbnail:e.bun.image}),!!e.filling.length&&Object(p.jsx)(me,{isDrag:i&&o,canDrop:o}),!!e.bun&&Object(p.jsx)(g.ConstructorElement,{type:"bottom",isLocked:!0,text:e.bun.name+" (\u043d\u0438\u0437)",price:e.bun.price,thumbnail:e.bun.image})]}),!!e.bun&&!!e.filling.length&&Object(p.jsx)(Ne,{}),Object(p.jsx)("div",{style:{overflow:"hidden"},children:t.openDetails&&Object(p.jsx)(Te,{onClose:function(){n({type:"orders/closeDetails"}),n((function(e){e({type:"burger/clear"}),e({type:"foods/clearCounts"})}))},isLoading:t.isLoading,children:Object(p.jsx)(Ue,{orders:t})})})]})},Ve=n(201),Qe=n(108),Ye=function(){var e=s((function(e){return e.foods})),t=e.isLoading,n=e.isError,r=e.isLoaded;return Object(p.jsxs)(p.Fragment,{children:[r&&Object(p.jsx)(Ve.a,{backend:Qe.a,children:Object(p.jsxs)("div",{className:Q.a.content,children:[Object(p.jsx)(re,{}),Object(p.jsx)(Ge,{})]})}),t&&Object(p.jsx)(Re,{text:"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u043c\u0435\u043d\u044e"}),n&&Object(p.jsx)(Je,{})]})},We=n(33),Ze=n.n(We),qe=function(e){var t=e.footerLinks;return Object(p.jsx)("div",{className:Ze.a.footer,children:t.map((function(e,t){return Object(p.jsxs)("div",{className:Ze.a.footerBlock,children:[Object(p.jsx)("span",{className:"text text_type_main-default ".concat(Ze.a.footerDesc),children:e.desc}),"\xa0\xa0",Object(p.jsx)(_.b,{to:e.pathname,children:Object(p.jsxs)("span",{className:"text text_type_main-default ".concat(Ze.a.footerLink),children:[" ",e.text," "]})})]},t)}))})},Ke=function(e){var t=e.data,n=u(),c=t.title,a=t.arrInputs,o=t.footerLinks,i=t.confirm,l=s((function(e){return e.authForm.arrInputs}));Object(r.useEffect)((function(){n({type:"auth/setInputs",payload:a})}),[]);return Object(p.jsxs)("form",{className:Ze.a.form,onSubmit:function(e){return function(e){e.preventDefault(),i.callback()}(e)},children:[!!c&&Object(p.jsx)("h2",{className:"text text_type_main-medium",children:c}),l.map((function(e){return Object(p.jsx)(g.Input,{type:e.type,name:e.name,value:e.value,icon:"password"===e.type?"HideIcon":e.icon,placeholder:e.placeholder,onChange:function(t){return n({type:"auth/handleInput",payload:{name:e.name,value:t.target.value}})},onIconClick:function(){return n({type:"auth/handleIcon",payload:e})}},e.name)})),Object(p.jsx)(g.Button,{children:i.text?i.text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),!!o&&Object(p.jsx)(qe,{footerLinks:o})]})},Xe=n(37),$e={user:{email:"",name:"",isAuth:!1,canRestorePass:!1},form:{inputs:{name:"",email:"",password:""}},profileIsLoading:!1,porfileIsLoaded:!1,profileIsError:!1},et=Object(N.b)({name:"profile",initialState:$e,reducers:{profileLoading:function(e){e.profileIsLoading=!0,e.profileIsError=!1,e.porfileIsLoaded=!1},profileIsError:function(e){e.profileIsLoading=!1,e.profileIsError=!0,e.porfileIsLoaded=!1},profileSuccess:function(e,t){e.profileIsLoading=!1,e.profileIsError=!1,e.porfileIsLoaded=!0},setProfile:function(e,t){e.user=Object(f.a)(Object(f.a)({},t.payload),{},{isAuth:!0}),e.form.inputs.email=t.payload.email,e.form.inputs.name=t.payload.name},clearProfile:function(e){return $e},onChangeInput:function(e,t){var n=t.payload,r=n.key,c=n.value;e.form.inputs=Object(f.a)(Object(f.a)({},e.form.inputs),{},Object(Xe.a)({},r,c))},toggleRestorePass:function(e){e.user=Object(f.a)(Object(f.a)({},e.user),{},{canRestorePass:!e.user.canRestorePass})}}}),tt=function(){return function(e){F().then((function(){return function(){var e=S("accessToken");return e?fetch("".concat(T,"/auth/user"),{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+e}}).then((function(e){return P(e)})):Promise.reject("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0435\u043d: \u043d\u0435\u0442 \u0442\u043e\u043a\u0435\u043d\u0430")}()})).then((function(t){return e(lt(t.user))})).then((function(){return e({type:"wsOrders/wsInit"})})).catch((function(t){console.log("Err with get User",t),e(jt())}))}},nt=function(){return function(e,t){var n=t().authForm.data;e({type:"profile/profileLoading"}),function(e){return fetch("".concat(T,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return P(e)}))}(n).then((function(t){var n={name:t.user.name,email:t.user.email};localStorage.setItem("refreshToken",t.refreshToken),L("accessToken",t.accessToken.split("Bearer ")[1]),Object(i.b)((function(){e({type:"profile/setProfile",payload:n}),e({type:"profile/profileSuccess"}),e({type:"auth/clearForm"})}))})).catch((function(t){console.log("Error with login",t),e({type:"profile/profileIsError"})}))}},rt=function(){return function(e,t){var n=t().authForm.data;e({type:"profile/profileLoading"}),function(e){return fetch("".concat(T,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return P(e)}))}(n).then((function(t){var n={name:t.user.name,email:t.user.email};Object(i.b)((function(){e({type:"profile/setProfile",payload:n}),e({type:"profile/profileSuccess"}),e({type:"auth/clearForm"})})),localStorage.setItem("refreshToken",t.refreshToken),L("accessToken",t.accessToken.split("Bearer ")[1])})).catch((function(t){console.log("Error with register",t),e({type:"profile/profileIsError"})}))}},ct=function(){return function(e){(function(){var e=localStorage.getItem("refreshToken");return fetch("".concat(T,"/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:e},body:JSON.stringify({token:e})}).then((function(e){return P(e)}))})().then((function(){e(dt()),localStorage.removeItem("refreshToken"),L("accessToken",null)})).catch((function(e){console.log("Err with logout User",e)}))}},at=function(e){return function(t){F().then((function(){return function(e){fetch("".concat(T,"/auth/user"),{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+S("accessToken")},body:JSON.stringify(e)}).then((function(e){return P(e)}))}(e)})).then((function(e){return t(lt(e.user))})).catch((function(e){console.log("Err with update User",e),t(jt())}))}},ot=function(){return function(e,t){(function(e){return fetch("".concat(T,"/password-reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return P(e)}))})(t().authForm.data).then((function(t){console.log("RESULT of resetPass",t),e(bt())})).catch((function(e){return console.log("Error with reset pass",e)}))}},it=function(){return function(e,t){var n=t().authForm.data;(function(e){return fetch("".concat(T,"/password-reset/reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return P(e)}))})({password:n.password,token:n.token}).then((function(){return e(bt())})).catch((function(e){return console.log("Error with set new pass",e)}))}},st=et.reducer,ut=et.actions,lt=ut.setProfile,dt=ut.clearProfile,jt=(ut.profileLoading,ut.profileSuccess,ut.profileIsError),ft=ut.onChangeInput,bt=ut.toggleRestorePass,pt=function(){var e,t=Object(l.h)(),n=s((function(e){return e.profile.user.isAuth})),r=u(),c={callback:function(){return r(nt())},text:"\u0412\u043e\u0439\u0442\u0438"};return n?Object(p.jsx)(l.a,{to:(null===(e=t.state)||void 0===e?void 0:e.from)||"/"}):Object(p.jsx)(Ke,{data:{title:"\u0412\u0445\u043e\u0434",arrInputs:[{name:"email",type:"email",placeholder:"E-mail",value:""},{name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:""}],footerLinks:[{desc:"\u0412\u044b - \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",text:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",pathname:"/register"},{desc:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",pathname:"/forgot-password"}],confirm:c}})},mt=function(){var e={callback:function(){return t(rt())},text:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"},t=u();return s((function(e){return e.profile.user.isAuth}))?Object(p.jsx)(l.a,{to:"/"}):Object(p.jsx)(Ke,{data:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",arrInputs:[{name:"name",type:"text",placeholder:"\u0418\u043c\u044f",value:""},{name:"email",type:"email",placeholder:"E-mail",value:""},{name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:""}],footerLinks:[{desc:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:e}})},xt=function(){var e=u(),t={callback:function(){return e(ot())},text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"},n=s((function(e){return e.profile.user})),r=n.isAuth,c=n.canRestorePass;return console.log("canRestorePass=",c),r?Object(p.jsx)(l.a,{to:"/"}):c?Object(p.jsx)(l.a,{to:"/reset-password"}):Object(p.jsx)(Ke,{data:{title:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f",arrInputs:[{name:"email",type:"email",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",value:""}],footerLinks:[{desc:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:t}})},ht=function(){var e=u(),t={callback:function(){return e(it())},text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"},n=s((function(e){return e.profile.user})),r=n.isAuth,c=n.canRestorePass;return r?Object(p.jsx)(l.a,{to:"/"}):c?Object(p.jsx)(Ke,{data:{title:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f",arrInputs:[{name:"password",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",value:""},{name:"token",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",value:""}],footerLinks:[{desc:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:t}}):Object(p.jsx)(l.a,{to:"/login"})},Ot=function(){return Object(p.jsx)("h1",{className:Q.a.noPage+" text text_type_main-large",children:"\u0412 \u044d\u0442\u043e\u0439 \u0412\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0442\u0430\u043a\u043e\u0439 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u043f\u043e\u043a\u0430"})},gt=function(){return Object(p.jsx)("h1",{className:Q.a.noOrderPage+" text text_type_main-medium",children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0443\u043a\u0430\u0437\u0430\u043d"})},_t=function(){return Object(p.jsx)("h1",{className:Q.a.noOrderPage+" text text_type_main-medium",children:"\u041d\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0437\u0430\u043a\u0430\u0437\u044b \u0435\u0449\u0451"})},yt=n(27),vt=n.n(yt),Nt=c.a.memo((function(e){var t=e.ingredient,n=e.children;return Object(p.jsxs)("div",{className:vt.a.container,children:[Object(p.jsx)("img",{className:vt.a.image,src:t.image_large,alt:t.name}),Object(p.jsx)("h3",{className:"text text_type_main-medium mb-4 mt-4",children:t.name}),Object(p.jsxs)("div",{className:vt.a.composition+" mt-4 mb-8",children:[Object(p.jsxs)("div",{className:vt.a.composeItem,children:[Object(p.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u041a\u0430\u043b"}),Object(p.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.calories})]}),Object(p.jsxs)("div",{className:vt.a.composeItem,children:[Object(p.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(p.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.proteins})]}),Object(p.jsxs)("div",{className:vt.a.composeItem,children:[Object(p.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(p.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.fat})]}),Object(p.jsxs)("div",{className:vt.a.composeItem,children:[Object(p.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(p.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.carbohydrates})]})]}),!!n&&n]})})),It=c.a.memo((function(e){var t=e.ingredient,n=s((function(e){return e.burger.bun})),r=u(),c=Object(l.g)();return Object(p.jsx)(Nt,{ingredient:t,children:("bun"!==t.type||JSON.stringify(t)!==JSON.stringify(n))&&Object(p.jsx)(g.Button,{type:"primary",size:"medium",onClick:function(){r(fe(t)),r({type:"ingredient/closeIngredient"}),c.push("/")},children:"bun"===t.type&&n?"\u0417\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u0443\u043b\u043a\u0443 \u0432 \u0431\u0443\u0440\u0433\u0435\u0440\u0435":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a \u0431\u0443\u0440\u0433\u0435\u0440\u0443"})})})),wt=function(){var e=s((function(e){return e.ingredient})),t=u(),n=Object(l.g)();return Object(p.jsx)("div",{style:{position:"fixed",overflow:"hidden"},children:e.show&&Object(p.jsx)(Te,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",onClose:function(){t({type:"ingredient/closeIngredient"}),n.push("/")},children:Object(p.jsx)(It,{ingredient:e.item})})})},kt=function(){var e=Object(l.i)().id,t=s((function(e){return e.foods})),n=t.isLoading,c=t.isError,a=t.isLoaded,o=t.items,i=Object(r.useState)(),u=Object(q.a)(i,2),d=u[0],j=u[1];return Object(r.useEffect)((function(){if(o.length){var t=o.find((function(t){return t._id===e}));t&&j(t)}}),[a,o,e]),Object(p.jsxs)("div",{className:Q.a.modalPage,children:[a&&Object(p.jsx)(p.Fragment,{children:d?Object(p.jsx)(Nt,{ingredient:d}):Object(p.jsx)(Ot,{})}),n&&Object(p.jsx)(Re,{text:"\u0418\u0449\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(p.jsx)(Je,{})]})},Et=n(34),Ct=n.n(Et),St=n(104),Lt=n.n(St),Tt=n(23),Pt=n.n(Tt),Ft=c.a.memo((function(e){var t=e.burger,n=Object(l.h)(),r=u(),c=t._id,a=t.number,o=t.name,i=t.ingredients,s=t.total,d=t.createdAt;return Object(p.jsx)(_.b,{to:{pathname:"".concat(n.pathname,"/").concat(c),state:{background:n}},children:Object(p.jsxs)("div",{className:Pt.a.card,onClick:function(){return r({type:"burgerOrder/openOrder",payload:t})},children:[Object(p.jsxs)("div",{className:Pt.a.cardHeader,children:[Object(p.jsx)(Rt,{number:a}),Object(p.jsx)(Dt,{time:d})]}),Object(p.jsx)("p",{className:"text text_type_main-medium",children:o}),Object(p.jsxs)("div",{className:Pt.a.cardFooter,children:[Object(p.jsx)(Bt,{images:i.map((function(e){return e.image}))}),Object(p.jsx)(Ht,{total:s})]})]})})})),Bt=function(e){var t=e.images,n=t.length>6,r=Object(le.a)(t).reverse();return Object(p.jsx)("div",{className:Pt.a.cardImages,children:r.map((function(e,t){return t<6&&Object(p.jsx)(At,{image:e,text:0===t&&n?"+"+(r.length-5):"",type:"row"},t)}))})},Dt=function(e){var t=e.time;return Object(p.jsx)("p",{className:"text text_type_main-default",style:{color:"var(--text-secondary-color)"},children:function(){var e=new Date(t),n=e.getDate(),r=e.getMonth(),c=e.getFullYear(),a=(new Date).getDate(),o=new Date(c,r+1,0).getDate(),i=a>=n?a-n:o+a-n,s=0===i?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f ":1===i?"\u0412\u0447\u0435\u0440\u0430 ":i%10===2||i%10===3||i%10===4?String(i)+" \u0434\u043d\u044f \u043d\u0430\u0437\u0430\u0434 ":i%10===1?String(i)+" \u0434\u0435\u043d\u044c \u043d\u0430\u0437\u0430\u0434":String(i)+" \u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434 ",u=" i-GMT"+e.toTimeString().substring(12,18).replaceAll("0","");return s+e.getHours()+":"+e.getMinutes()+u}()})},At=function(e){var t=e.image,n=e.text,r=e.type;return Object(p.jsx)("div",{className:Pt.a.imageContainer,style:"row"===r?{marginRight:"-16px"}:{},children:Object(p.jsx)("div",{className:n?Pt.a.cardImageBlur:Pt.a.cardImage,style:{backgroundImage:"url("+t+")"},children:!!n&&Object(p.jsx)("span",{className:"text text_type_digits-default",style:{zIndex:100},children:n})})})},Ht=function(e){var t=e.total;return Object(p.jsxs)("div",{className:Pt.a.cardTotal,children:[Object(p.jsx)("span",{className:"text text_type_digits-default mr-2",children:t}),Object(p.jsx)(g.CurrencyIcon,{type:"primary"})]})},Rt=function(e){var t=e.number;return Object(p.jsxs)("p",{className:"text text_type_digits-default",children:["#",t]})},Mt=function(e){var t=e.title,n=e.burgers;return Object(p.jsxs)("article",{className:Lt.a.burgers,children:[!!t&&Object(p.jsx)("h1",{className:"text text_type_main-large mb-3 mt-10",children:t}),Object(p.jsx)(ne,{bottom:16,id:"feed",children:Object(p.jsx)("div",{children:n.map((function(e){return Object(p.jsx)(Ft,{burger:e},e._id)}))})})]})},zt=function(){var e=Object(l.j)().path;return Object(p.jsxs)("div",{className:Ct.a.profile,children:[Object(p.jsx)(Jt,{}),Object(p.jsxs)(l.d,{children:[Object(p.jsx)(l.b,{path:"".concat(e),exact:!0,children:Object(p.jsx)(Ut,{})}),Object(p.jsx)(l.b,{path:"".concat(e,"/orders"),exact:!0,children:Object(p.jsx)(Gt,{})}),Object(p.jsx)(l.b,{path:"".concat(e,"/orders/:id"),exact:!0,children:Object(p.jsx)(rn,{type:"profile"})}),Object(p.jsx)(l.b,{children:Object(p.jsx)(l.a,{to:"".concat(e)})})]})]})},Jt=function(){var e=Object(l.j)().url,t=u(),n="text text_type_main-medium ".concat(Ct.a.link),r="text text_type_main-medium ".concat(Ct.a.activeLink);return Object(p.jsxs)("div",{className:Ct.a.menu,children:[Object(p.jsx)(_.c,{exact:!0,to:"".concat(e),className:n,activeClassName:r,children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(p.jsx)(_.c,{to:"".concat(e,"/orders"),className:n,activeClassName:r,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(p.jsx)("span",{className:n,onClick:function(){return t(ct())},children:"\u0412\u044b\u0445\u043e\u0434"})]})},Ut=function(){var e=s((function(e){return e.profile.form})),t=u();return Object(p.jsxs)("form",{className:Ct.a.form,onSubmit:function(n){return function(n){n.preventDefault(),t(at(e.inputs))}(n)},id:"profileForm",children:[Object(p.jsx)(g.Input,{type:"text",value:e.inputs.name,placeholder:"\u0418\u043c\u044f",icon:"EditIcon",onChange:function(e){return t(ft({key:"name",value:e.target.value}))}}),Object(p.jsx)(g.Input,{type:"email",value:e.inputs.email,placeholder:"E-mail",icon:"EditIcon",onChange:function(e){return t(ft({key:"email",value:e.target.value}))}}),Object(p.jsx)(g.Input,{type:"password",value:e.inputs.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",icon:"EditIcon",onChange:function(e){return t(ft({key:"password",value:e.target.value}))}}),Object(p.jsx)("div",{className:Ct.a.formSubmit,children:Object(p.jsx)(g.Button,{children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]})},Gt=function(){var e=s((function(e){return e.wsOrders})),t=e.orders,n=e.success,c=e.isError,a=s((function(e){return e.foods.isLoaded})),o=u();return Object(r.useEffect)((function(){a&&!n&&o({type:"wsOrders/wsInit"})}),[a,n,o]),Object(r.useEffect)((function(){return function(){o({type:"wsOrders/wsClosed"})}}),[]),Object(p.jsxs)(p.Fragment,{children:[t&&n?t.length?Object(p.jsx)(Mt,{burgers:t}):Object(p.jsx)(_t,{}):Object(p.jsx)(Re,{text:"\u0423\u0442\u043e\u0447\u043d\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(p.jsx)(Je,{})]})},Vt=n(28),Qt=n.n(Vt),Yt=function(){var e=s((function(e){return e.wsFeed})),t=e.orders,n=e.total,c=e.totalToday,a=Object(r.useState)({arrDone:[],arrNotReady:[]}),o=Object(q.a)(a,2),i=o[0],u=o[1];return Object(r.useEffect)((function(){t&&t.length&&u({arrDone:t.filter((function(e){return"done"===e.status})).map((function(e){return e.number})),arrNotReady:t.filter((function(e){return"done"!==e.status})).map((function(e){return e.number}))})}),[t]),Object(p.jsxs)("article",{className:Qt.a.status,children:[Object(p.jsxs)("div",{className:Qt.a.data,children:[Object(p.jsx)(Wt,{title:"\u0413\u043e\u0442\u043e\u0432\u044b:",arr:i.arrDone,type:"primary"}),Object(p.jsx)(Wt,{title:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:",arr:i.arrNotReady,type:"secondary"})]}),Object(p.jsxs)("div",{className:Qt.a.total,children:[Object(p.jsx)(Zt,{title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f:",count:n}),Object(p.jsx)(Zt,{title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:",count:c})]})]})},Wt=c.a.memo((function(e){var t=e.arr,n=e.title,r=e.type;return Object(p.jsxs)("div",{className:Qt.a.columns,children:[Object(p.jsx)("h3",{className:"text text_type_main-medium mb-6",children:n}),Object(p.jsx)("div",{className:Qt.a.digits,children:t.map((function(e,t){return t<30&&Object(p.jsx)("p",{className:"text text_type_digits-default",style:{color:"var(--text-"+r+"-color)"},children:e},t)}))})]})})),Zt=c.a.memo((function(e){var t=e.title,n=e.count,r=new Intl.NumberFormat("ru");return Object(p.jsxs)("div",{className:Qt.a.count,children:[Object(p.jsx)("h3",{className:"text text_type_main-medium",children:t}),Object(p.jsx)("p",{className:"text text_type_digits-large ".concat(Qt.a.totalDigits),children:r.format(n+0)})]})})),qt=function(){var e=s((function(e){return e.wsFeed})),t=e.orders,n=e.success,c=e.isError,a=s((function(e){return e.foods.isLoaded})),o=u();return Object(r.useEffect)((function(){a&&!n&&o({type:"wsFeed/wsInit"})}),[a,n,o]),Object(r.useEffect)((function(){return function(){o({type:"wsFeed/wsClosed"})}}),[]),Object(p.jsxs)(p.Fragment,{children:[t&&n?Object(p.jsxs)("div",{className:Q.a.content,children:[Object(p.jsx)(Mt,{burgers:t,title:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(p.jsx)(Yt,{})]}):Object(p.jsx)(Re,{text:"\u0423\u0442\u043e\u0447\u043d\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(p.jsx)(Je,{})]})},Kt=n(29),Xt=n.n(Kt),$t=function(e){var t=e.order,n=t.name,r=t.number,c=(t._id,t.status),a=t.ingredients,o=t.createdAt,i=t.total;return Object(p.jsxs)("div",{className:Xt.a.order,children:[Object(p.jsx)("div",{className:Xt.a.header,children:Object(p.jsx)(Rt,{number:r})}),Object(p.jsx)("h1",{className:"text text_type_main-medium",children:n}),Object(p.jsx)("span",{className:"text text_type_main-default mt-3 mb-10",style:{color:"var(--text-success-color"},children:"done"===c?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d":"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f"}),Object(p.jsx)(en,{ingredients:a}),Object(p.jsxs)("div",{className:Xt.a.footer,children:[Object(p.jsx)(Dt,{time:o}),Object(p.jsx)(Ht,{total:i})]})]})},en=function(e){var t=e.ingredients;return Object(p.jsxs)("div",{className:Xt.a.recipe,children:[Object(p.jsx)("h3",{className:"text text_type_main-medium mb-6 mt-5",children:"\u0421\u043e\u0441\u0442\u0430\u0432"}),Object(p.jsx)(ne,{id:"recipe",children:Object(p.jsx)("div",{className:Xt.a.ingredients,children:t.map((function(e,t){return Object(p.jsx)(tn,{ingredient:e},e._id+t)}))})})]})},tn=function(e){var t=e.ingredient,n="bun"===t.type?2:1*t.price;return Object(p.jsxs)("div",{className:Xt.a.ingredient,children:[Object(p.jsxs)("div",{className:Xt.a.about,children:[Object(p.jsx)(At,{image:t.image}),Object(p.jsx)("p",{className:"text text_type_main-default ml-4",children:t.name})]}),Object(p.jsx)(Ht,{total:n})]})},nn=function(){var e=s((function(e){return e.burgerOrder})),t=u(),n=Object(l.g)();return Object(p.jsx)("div",{style:{position:"fixed",overflow:"hidden"},children:e.show&&Object(p.jsx)(Te,{onClose:function(){t({type:"burgerOrder/closeOrder"}),n.goBack()},children:Object(p.jsx)($t,{order:e.item})})})},rn=function(e){var t=e.type,n=Object(l.i)().id,c=s((function(e){return e.wsFeed.orders})),a=s((function(e){return e.wsOrders.orders})),o=Object(r.useState)({order:null,isLoading:!0}),i=Object(q.a)(o,2),u=i[0],d=i[1];Object(r.useEffect)((function(){c&&"feed"===t&&d({order:c.find((function(e){return e._id===n})),isLoading:!1}),a&&"profile"===t&&d({order:a.find((function(e){return e._id===n})),isLoading:!1})}),[c,a,n,t]);var j=u.order,f=u.isLoading;return Object(p.jsxs)("div",{className:Q.a.modalPage,children:[!f&&Object(p.jsx)(p.Fragment,{children:j?Object(p.jsx)($t,{order:j}):Object(p.jsx)(gt,{})}),f&&Object(p.jsx)(Re,{text:"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0437\u0430\u043a\u0430\u0437"})]})},cn=function(){var e=u(),t=Object(l.g)(),n=Object(l.h)();Object(r.useEffect)((function(){e(U()),e(tt())}),[]);var c=n.state&&"push"===t.action.toLowerCase()&&n.state.background;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(v,{}),Object(p.jsxs)("main",{className:j.a.main,children:[Object(p.jsxs)(l.d,{location:c||n,children:[Object(p.jsx)(x,{path:"/profile",children:Object(p.jsx)(zt,{})}),Object(p.jsx)(l.b,{path:"/",exact:!0,children:Object(p.jsx)(Ye,{})}),Object(p.jsx)(l.b,{path:"/login",exact:!0,children:Object(p.jsx)(pt,{})}),Object(p.jsx)(l.b,{path:"/register",exact:!0,children:Object(p.jsx)(mt,{})}),Object(p.jsx)(l.b,{path:"/forgot-password",exact:!0,children:Object(p.jsx)(xt,{})}),Object(p.jsx)(l.b,{path:"/reset-password",exact:!0,children:Object(p.jsx)(ht,{})}),Object(p.jsx)(l.b,{path:"/feed",exact:!0,children:Object(p.jsx)(qt,{})}),Object(p.jsx)(l.b,{path:"/feed/:id",exact:!0,children:Object(p.jsx)(rn,{type:"feed"})}),Object(p.jsx)(l.b,{path:"/ingredients/:id",exact:!0,children:Object(p.jsx)(kt,{})}),Object(p.jsx)(l.b,{children:Object(p.jsx)(Ot,{})})]}),c&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(l.b,{path:"/ingredients/:id",exact:!0,children:Object(p.jsx)(wt,{})}),Object(p.jsx)(l.b,{path:"/feed/:id",exact:!0,children:Object(p.jsx)(nn,{})}),Object(p.jsx)(x,{path:"/profile/orders/:id",exact:!0,children:Object(p.jsx)(nn,{})})]})]})]})},an=n(105),on=n(106),sn=n(110),un=n(109),ln=function(e){Object(sn.a)(n,e);var t=Object(un.a)(n);function n(){var e;Object(an.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(on.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log("Cath error",e,t)}},{key:"render",value:function(){return this.state.hasError?Object(p.jsx)(Je,{}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.Component),dn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,204)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},jn=n(107),fn=n.n(jn),bn=n(13),pn=Object(N.b)({name:"ingredient",initialState:{show:!1,item:null},reducers:{openIngredient:function(e,t){e.show=!0,e.item=t.payload},closeIngredient:function(e){e.show=!1,e.item=null}}}),mn=pn.actions,xn=pn.reducer,hn=(mn.openIngredient,mn.closeIngredient,Object(N.b)({name:"header",initialState:{burger:{type:"secondary",icon:"burger",text:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440",link:"/"},orders:{type:"secondary",icon:"list",text:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432",link:"/feed"},profile:{type:"secondary",icon:"profile",text:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442",link:"/profile"}},reducers:{onChangeLink:function(e,t){for(var n in e)e[n]=n===t.payload?Object(f.a)(Object(f.a)({},e[n]),{},{type:"primary"}):Object(f.a)(Object(f.a)({},e[n]),{},{type:"secondary"})}}})),On=hn.actions,gn=hn.reducer,_n=(On.onChangeLink,{arrInputs:[],data:{}}),yn=Object(N.b)({name:"auth",initialState:_n,reducers:{setInputs:function(e,t){var n=t.payload;e.arrInputs=n.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{icon:"password"===e.type?"HideIcon":e.icon,valid:!1,error:""})}))},clearForm:function(e){return _n},handleInput:function(e,t){var n=t.payload,r=n.name,c=n.value;e.data=Object(f.a)(Object(f.a)({},e.data),{},Object(Xe.a)({},r,c)),e.arrInputs=e.arrInputs.map((function(e){return e.name===r?Object(f.a)(Object(f.a)({},e),{},{value:c}):e}))},handleIcon:function(e,t){var n=t.payload;"password"===n.name&&(e.arrInputs=e.arrInputs.map((function(e){return n.name===e.name?Object(f.a)(Object(f.a)({},n),{},{type:"password"===n.type?"text":"password",icon:"password"===n.type?"ShowIcon":"HideIcon"}):e})))}}}),vn=yn.reducer,Nn=yn.actions,In=(Nn.setInputs,Nn.clearForm,Nn.handleInput,Nn.handleIcon,Object(N.b)({name:"burgerOrder",initialState:{show:!1,item:null},reducers:{openOrder:function(e,t){e.show=!0,e.item=t.payload},closeOrder:function(e){e.show=!1,e.item=null}}})),wn=In.actions,kn=In.reducer,En=(wn.openOrder,wn.closeOrder,Object(N.b)({name:"wsFeed",initialState:{success:!1,isError:!1,orders:null,total:0,totalToday:0},reducers:{wsError:function(e){e.success=!1,e.isError=!0},wsSuccess:function(e,t){e.success=!0},wsClosed:function(e,t){e.success=!1},wsGetFeed:function(e,t){return t.payload}}})),Cn=En.reducer,Sn=En.actions,Ln=(Sn.wsError,Sn.wsSuccess,Sn.wsClosed,Sn.wsGetFeed,Object(N.b)({name:"wsOrders",initialState:{success:!1,isError:!1,orders:null},reducers:{wsError:function(e){e.success=!1,e.isError=!0},wsSuccess:function(e,t){e.success=!0},wsClosed:function(e,t){e.success=!1},wsGetOrders:function(e,t){return t.payload}}})),Tn=Ln.reducer,Pn=Ln.actions,Fn=(Pn.wsError,Pn.wsSuccess,Pn.wsClosed,Pn.wsGetOrders,Object(bn.b)({foods:H,burger:pe,orders:Oe,ingredient:xn,header:gn,profile:st,authForm:vn,burgerOrder:kn,wsFeed:Cn,wsOrders:Tn})),Bn=(Object(f.a)(Object(f.a)(Object(f.a)({},hn.actions),yn.actions),et.actions),function(e,t){return function(n){var r=null;return function(c){return function(a){var o=n.dispatch,i=n.getState,s=a.type,u=t.wsInit,l=t.onOpen,d=t.onClose,j=t.onError,b=t.onMessage,p=i().foods.items;s===u&&(r=new WebSocket(e)),r&&(r.onopen=function(e){o({type:l})},r.onerror=function(e){o({type:j})},r.onmessage=function(e){var t=e.data,n=JSON.parse(t),r=n.orders.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{ingredients:e.ingredients.map((function(e){return p.find((function(t){return e===t._id}))})).filter((function(e){return!!e}))})}));o({type:b,payload:Object(f.a)(Object(f.a)({},n),{},{success:!0,orders:r.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{total:e.ingredients.reduce((function(e,t){return e+t.price*("bun"===t.type?2:1)}),0)})}))})})},r.onclose=function(e){o({type:d})}),c(a)}}}}),Dn={wsInit:"wsFeed/wsInit",onOpen:"wsFeed/wsSuccess",onClose:"wsFeed/wsClosed",onError:"wsFeed/wsError",onMessage:"wsFeed/wsGetFeed"},An="wss://norma.nomoreparties.space/orders?token="+S("accessToken"),Hn={wsInit:"wsOrders/wsInit",onOpen:"wsOrders/wsSuccess",onClose:"wsOrders/wsClosed",onError:"wsOrders/wsError",onMessage:"wsOrders/wsGetOrders"},Rn=Object(N.a)({reducer:Fn,middleware:function(e){return e().concat(fn.a,Bn("wss://norma.nomoreparties.space/orders/all",Dn),Bn(An,Hn))},devTools:!1});o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(ln,{children:Object(p.jsx)(i.a,{store:Rn,children:Object(p.jsx)(_.a,{basename:"/burger",children:Object(p.jsx)(cn,{})})})})}),document.getElementById("root")),dn()},20:function(e,t,n){e.exports={content:"pages_content__TpO_W",noPage:"pages_noPage__3xkgD",noOrderPage:"pages_noOrderPage__1hNU3 pages_noPage__3xkgD",modalPage:"pages_modalPage__UE8PE"}},22:function(e,t,n){e.exports={main:"burger-constructor_main__2tNbw",menu:"burger-constructor_menu__sONAg",dropContainer:"burger-constructor_dropContainer__Zjt8T",filling:"burger-constructor_filling__2fgAv",confirm:"burger-constructor_confirm__3NS70",orderPrice:"burger-constructor_orderPrice__3AlD8",recipe:"burger-constructor_recipe__3vUgp"}},23:function(e,t,n){e.exports={card:"burger-card_card__30_sB",cardHeader:"burger-card_cardHeader__3AvS1",cardFooter:"burger-card_cardFooter__2BWi2",cardTotal:"burger-card_cardTotal__3jUzz",cardImages:"burger-card_cardImages__3QA7Q",imageContainer:"burger-card_imageContainer__294ZG",cardImage:"burger-card_cardImage__3suQg",cardImageBlur:"burger-card_cardImageBlur__1wimx burger-card_cardImage__3suQg"}},27:function(e,t,n){e.exports={container:"ingredients-details_container__3uS5N",composition:"ingredients-details_composition__wYmpZ",composeItem:"ingredients-details_composeItem__1EVnk",image:"ingredients-details_image__3YRQs"}},28:function(e,t,n){e.exports={status:"feed-status_status__2TSop",data:"feed-status_data__Yyewg",columns:"feed-status_columns__3cz0E",digits:"feed-status_digits__1YHIi",total:"feed-status_total__3M4sv",totalDigits:"feed-status_totalDigits__F2CQl",count:"feed-status_count__CWVfR"}},29:function(e,t,n){e.exports={order:"burger-order_order__2SHCu",header:"burger-order_header__2tORc",footer:"burger-order_footer__3r0Bd",ingredients:"burger-order_ingredients__33wNb",ingredient:"burger-order_ingredient__192n2",about:"burger-order_about__2zK1n"}},32:function(e,t,n){e.exports={header:"app-header_header__1gtX5",content:"app-header_content__2DMzM",logo:"app-header_logo__2c-Yf","button-primary":"app-header_button-primary__3XgOa","button-secondary":"app-header_button-secondary__c8MyV app-header_button-primary__3XgOa",menu:"app-header_menu__2BfqR"}},33:function(e,t,n){e.exports={form:"form_form__1oY-K",footer:"form_footer__2aMqx",footerBlock:"form_footerBlock__1LJTT",footerDesc:"form_footerDesc__P6E6e",footerLink:"form_footerLink__1QOpS"}},34:function(e,t,n){e.exports={profile:"profile_profile___ZBKq",menu:"profile_menu__2zVJs",link:"profile_link__3eJaJ",activeLink:"profile_activeLink__1jnOS profile_link__3eJaJ",form:"profile_form__1oUU8",input_size_default:"profile_input_size_default__2VsF4",formSubmit:"profile_formSubmit__3F252"}},39:function(e,t,n){e.exports={container:"order-details_container__39iZT",icon:"order-details_icon__SQgvY",title:"order-details_title__37gWW",titleLoader:"order-details_titleLoader__36HNX"}},48:function(e,t,n){e.exports={container:"scrollbox_container__2Bl4W",scrollBarContainer:"scrollbox_scrollBarContainer__25fZX",content:"scrollbox_content__2y-GP",scrollbar:"scrollbox_scrollbar__3ORoV"}},57:function(e,t,n){e.exports={modalBox:"modal_modalBox__KI4un",closePosition:"modal_closePosition__1sEwP",content:"modal_content__3O20I"}},58:function(e,t,n){e.exports={container:"loader_container__1MVDK",icons:"loader_icons__3768C",rotateIcons:"loader_rotateIcons__2q2CU",icon:"loader_icon__1H6Wd",rotateIcon:"loader_rotateIcon__1sb08"}},79:function(e,t,n){e.exports={container:"error-message_container__1xeVZ",icons:"error-message_icons__3GgcV"}},99:function(e,t,n){e.exports={main:"app_main__3xsct"}}},[[196,1,2]]]);
//# sourceMappingURL=main.335aba80.chunk.js.map