(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{10:function(e,t,n){e.exports={ingredients:"burger-ingredients_ingredients__3ElkJ",menu:"burger-ingredients_menu__1AGSy",navigation:"burger-ingredients_navigation__2fOQ5",navLink:"burger-ingredients_navLink__EFZ70",navLinkActive:"burger-ingredients_navLinkActive__1Jxpi burger-ingredients_navLink__EFZ70",sections:"burger-ingredients_sections__WEVwA",sectionFood:"burger-ingredients_sectionFood__2yBV9",cards:"burger-ingredients_cards__1_ztt",card:"burger-ingredients_card__2orry",cardPrice:"burger-ingredients_cardPrice__1i_8M",cardTitle:"burger-ingredients_cardTitle__3obuH",count:"burger-ingredients_count__3NHUR",cardText:"burger-ingredients_cardText__2go2e",cardImage:"burger-ingredients_cardImage__1pVfE"}},103:function(e,t,n){e.exports={overlay:"modal-overlay_overlay__21jg3"}},104:function(e,t,n){e.exports={burgers:"feed-burgers_burgers__KapyN",cards:"feed-burgers_cards__xs5Q_"}},117:function(e,t,n){},196:function(e,t,n){"use strict";n.r(t),n.d(t,"store",(function(){return Rn}));var r=n(1),c=n.n(r),a=n(36),o=n.n(a),i=(n(117),n(25)),s=i.d,u=function(){return Object(i.c)()},l=n(9),d=n(99),j=n.n(d),f=n(3),p=n(111),b=n(0),m=["children"],x=function(e){var t=e.children,n=Object(p.a)(e,m),r=s((function(e){return e.profile.user.isAuth}));return Object(b.jsx)(l.b,Object(f.a)(Object(f.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(b.jsx)(l.a,{to:{pathname:"/login",state:{from:n}}})}}))},h=n(32),O=n.n(h),g=n(4),_=n(7),y=c.a.memo((function(e){var t=e.data,n=t.icon,r=t.text,c=t.link,a=t.type,o={burger:g.BurgerIcon,list:g.ListIcon,profile:g.ProfileIcon}[n];return Object(b.jsx)(_.b,{to:c,children:Object(b.jsxs)("button",{className:O.a["button-"+a],children:[Object(b.jsx)(o,{type:a}),Object(b.jsx)("p",{className:"text text_type_main-small pl-1",children:r})]})})})),v=c.a.memo((function(){var e=s((function(e){return e.header})),t=u(),n=Object(l.h)().pathname;return Object(r.useEffect)((function(){var r=0,c="";for(var a in e){var o=e[a].link;n.includes(o)&&o.length>r&&(c=a,r=o.length),"/"===o&&"/"!==n&&(c="")}t({type:"header/onChangeLink",payload:c})}),[n]),Object(b.jsx)("header",{className:O.a.header,children:Object(b.jsxs)("nav",{className:O.a.content+" pt-4 pb-4",children:[Object(b.jsxs)("div",{className:O.a.menu,children:[Object(b.jsx)(y,{data:e.burger}),Object(b.jsx)(y,{data:e.orders})]}),Object(b.jsx)(y,{data:e.profile}),Object(b.jsx)("div",{className:O.a.logo,children:Object(b.jsx)(_.b,{to:"/",children:Object(b.jsx)(g.Logo,{})})})]})})})),N=n(8),w=n(26),I=n.n(w),k=n(44),E=function(e,t){return Math.floor(e+Math.random()*(t+1-e))};function C(e){var t=e.find((function(e){return"bun"===e.type})),n=e.filter((function(e){return"bun"!==e.type})).map((function(e,t){return Object(f.a)(Object(f.a)({},e),{},{unicId:t+e._id})})),r=n.reduce((function(e,t){return e+t.price}),0)+(t?2*t.price:0);return{recipe:e=n.concat(t||[]),bun:t,filling:n,totalPrice:r}}function S(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function L(e,t,n){var r=(n=n||{}).expires;if("number"==typeof r&&r){var c=new Date;c.setTime(c.getTime()+1e3*r),r=n.expires=c}r&&r.toUTCString&&(n.expires=r.toUTCString());var a=e+"="+(t=encodeURIComponent(null!==t?t:""));for(var o in n){a+="; "+o;var i=n[o];!0!==i&&(a+="="+i)}document.cookie=a}function T(e,t){return e.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{ingredients:e.ingredients.map((function(e){return t.find((function(t){return e===t._id}))})).filter((function(e){return!!e}))})}))}var P="https://norma.nomoreparties.space/api",F=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))},B=function(){var e=localStorage.getItem("refreshToken");return fetch("".concat(P,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:e},body:JSON.stringify({token:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))})).then((function(e){return localStorage.setItem("refreshToken",e.refreshToken),L("accessToken",e.accessToken.split("Bearer ")[1]),e}))},D={bun:"\u0411\u0443\u043b\u043a\u0438",main:"\u041d\u0430\u0447\u0438\u043d\u043a\u0430",sauce:"\u0421\u043e\u0443\u0441\u044b"},A=Object(N.b)({name:"foods",initialState:{items:[],sections:[],isLoading:!1,isError:!1,isLoaded:!1},reducers:{foodsLoading:function(e){e.isLoading=!0,e.isError=!1,e.isLoaded=!1},foodsError:function(e){e.isLoading=!1,e.isError=!0,e.isLoaded=!1},foodsSuccess:function(e,t){e.items=t.payload,e.isLoading=!1,e.isError=!1,e.isLoaded=!0,e.sections=function(e){var t=[];return e.forEach((function(e){var n=t.findIndex((function(t){return t.id===e.type}));n>-1?t[n].foods.push(Object(f.a)(Object(f.a)({},e),{},{count:0})):t.push({id:e.type,text:D[e.type],foods:[Object(f.a)(Object(f.a)({},e),{},{count:0})],active:!1})})),t}(t.payload)},clearCounts:function(e){e.sections.forEach((function(e){e.foods=e.foods.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{count:0})}))}))},setCounts:function(e,t){e.sections.forEach((function(e){return e.foods.forEach((function(e){return e.count=t.payload.reduce((function(t,n){return n._id===e._id?t+("bun"!==n.type?1:2):t}),0)}))}))},setActiveSection:function(e,t){e.sections=e.sections.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{active:e.id===t.payload})}))}}}),H=A.actions,R=A.reducer,M=H.foodsLoading,z=H.foodsError,J=H.foodsSuccess,U=(H.clearCounts,H.setCounts,H.setActiveSection),G=function(){return function(e){return e(M()),fetch("".concat(P,"/ingredients")).then((function(e){return F(e)})).then((function(t){return e(J(t.data))})).catch((function(t){return console.log("Error with ingredients:",t),e(z())}))}},V=function(e,t){e({type:"foods/setCounts",payload:t().burger.recipe})};var Q=n(20),Y=n.n(Q),W=n(10),Z=n.n(W),q=c.a.memo((function(e){var t=e.sections,n=u();return Object(b.jsxs)("div",{className:Z.a.menu,children:[Object(b.jsx)("h1",{className:"text text_type_main-large mb-5",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(b.jsx)("nav",{className:Z.a.navigation,children:t.map((function(e){return Object(b.jsx)("a",{href:"#".concat(e.id),className:(e.active?Z.a.navLinkActive:Z.a.navLink)+" pt-4 pb-4 text text_type_main-default",onClick:function(){return n(U(e.id))},children:e.text},e.id)}))})]})})),K=n(12),X=n(202),$=c.a.memo((function(e){var t=e.food,n=u(),r=Object(l.h)(),c=Object(X.a)({type:"food",item:t}),a=Object(K.a)(c,2)[1];return Object(b.jsx)(_.b,{to:{pathname:"/ingredients/".concat(t._id),state:{background:r}},children:Object(b.jsxs)("li",{className:Z.a.card,onClick:function(){return n({type:"ingredient/openIngredient",payload:t})},children:[Object(b.jsx)("img",{className:Z.a.cardImage,src:t.image,alt:t.name,ref:a}),Object(b.jsxs)("div",{className:Z.a.cardText,children:[Object(b.jsxs)("div",{className:Z.a.cardPrice,children:[Object(b.jsx)("span",{className:"text text_type_main-medium m-2",style:{lineHeight:"1"},children:t.price}),Object(b.jsx)(g.CurrencyIcon,{type:"primary"})]}),Object(b.jsx)("h3",{className:Z.a.cardTitle+" text text_type_main-default",children:t.name})]}),Object(b.jsx)("div",{className:Z.a.count,children:!!t.count&&Object(b.jsx)(g.Counter,{count:t.count,size:"default"})})]})})})),ee=c.a.memo((function(e){var t=e.sections,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(null!==n&&null!==n.current){var e=n.current.offsetHeight,t=0,r=n.current.closest("#ingredients");null!==r&&(t=r.clientHeight),t>e&&(n.current.style.paddingBottom=t-e+"px")}}),[t]),Object(b.jsx)("ul",{className:Z.a.sections,children:t.map((function(e,r){return Object(b.jsxs)("li",{className:Z.a.sectionFood,id:e.id,ref:r===t.length-1?n:void 0,children:[Object(b.jsx)("h2",{className:"text text_type_main-medium",children:e.text}),Object(b.jsx)("ul",{className:Z.a.cards,children:e.foods.map((function(e){return Object(b.jsx)($,{food:e},e._id)}))})]},e.id)}))})})),te=n(48),ne=n.n(te),re=c.a.memo((function(e){var t=Object(r.useState)(""),n=Object(K.a)(t,2),c=n[0],a=n[1],o=Object(r.useRef)(null),i=Object(r.useRef)(null),s=Object(r.useRef)(null),u=Object(r.useRef)(null);Object(r.useEffect)((function(){var t=o.current,n=i.current,r=s.current,c=u.current;t.style.paddingBottom=e.bottom?String(e.bottom)+"px":"0px",r.style.top=e.top?String(e.top)+"px":"0px",r.style.bottom=e.bottom?e.bottom+"px":"0px",c.style.height=String(r.clientHeight*n.clientHeight/n.scrollHeight)+"px";var d=function(){n.scrollHeight>n.clientHeight?(r.style.visibility="visible",c.style.top=r.clientHeight*n.scrollTop/n.scrollHeight+"px",e.arrBlocksId&&a(l())):r.style.visibility="hidden"};d(),n.addEventListener("scroll",d),c.addEventListener("mousedown",(function(e){e.preventDefault(),n.style.scrollBehavior="auto";var t=c.offsetTop,a=function(a){var o=a.pageY-e.pageY,i=Math.min(r.clientHeight-c.clientHeight,Math.max(0,t+o))/r.clientHeight;n.scrollTop=n.scrollHeight*i};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e),n.style.scrollBehavior="smooth"}))}))}),[e]),Object(r.useEffect)((function(){c&&e.callbackScroll&&e.callbackScroll(c)}),[c,e]);var l=Object(r.useCallback)((function(){var t,n=o.current,r=n.getBoundingClientRect().top,c=n.clientHeight+r,a=0;return e.arrBlocksId&&e.arrBlocksId.forEach((function(e){var n=document.querySelector("#".concat(e));if(n){var o=n.getBoundingClientRect().top,i=n.clientHeight+o,s=r>o?r-o:0,u=c<i?i-c:0,l=(n.clientHeight-s-u)/n.clientHeight;l>a&&(a=l,t=e)}})),t}),[e]);return Object(b.jsxs)("section",{className:ne.a.container,id:e.id?e.id:"scrollbox",ref:o,children:[Object(b.jsx)("div",{className:ne.a.scrollBarContainer,ref:s,children:Object(b.jsx)("div",{className:ne.a.scrollbar,ref:u})}),Object(b.jsx)("div",{className:ne.a.content,ref:i,children:e.children})]})})),ce=function(){var e=s((function(e){return e.foods.sections})),t=u(),n=Object(r.useCallback)((function(n){var r=e.find((function(e){return e.active}));r&&r.id===n||t(U(n))}),[e,t]);return Object(b.jsx)("article",{className:Z.a.ingredients,children:!!e.length&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(q,{sections:e}),Object(b.jsx)(re,{top:40,bottom:16,id:"ingredients",arrBlocksId:e.map((function(e){return e.id})),callbackScroll:n,children:Object(b.jsx)(ee,{sections:e})})]})})},ae=n(22),oe=n.n(ae),ie=n(203),se=function(e){var t=e.id,n=e.children,c=e.index,a=e.moveElement,o=Object(r.useRef)(null),i=Object(ie.a)({accept:"card",collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){var n;if(o.current){var r=e.index,i=c;if(r!==i){var s=null===(n=o.current)||void 0===n?void 0:n.getBoundingClientRect(),u=(s.bottom-s.top)/2,l=t.getClientOffset().y-s.top;r<i&&l<u||r>i&&l>u||(a(r,i),e.index=i)}}}}),s=Object(K.a)(i,2),u=s[0].handlerId,l=s[1],d=Object(X.a)({type:"card",item:function(){return{id:t,index:c}},collect:function(e){return{isDragging:e.isDragging()}}}),j=Object(K.a)(d,2),p=j[0].isDragging?0:1;return(0,j[1])(l(o)),Object(b.jsx)("div",{ref:o,"data-handler-id":u,style:Object(f.a)(Object(f.a)({},{padding:"0",margin:"0",backgroundColor:"transparent",cursor:"pointer"}),{},{opacity:p}),children:n})},ue=n(102),le=n.n(ue),de=n(38),je={recipe:[],totalPrice:null,bun:null,filling:[]},fe=Object(N.b)({name:"burger",initialState:je,reducers:{clear:function(e){return je},random:function(e,t){return C(function(e){for(var t=[],n=E(6,10),r=0;r<n;r++)t[r]=e[E(0,e.length-1)];if(!t.find((function(e){return"bun"===e.type}))){var c=e.find((function(e){return"bun"===e.type}));"undefined"!==typeof c&&t.push(c)}return t}(t.payload))},del:function(e,t){var n=e.filling.filter((function(e){return e.unicId!==t.payload}));return e.bun&&n.push(e.bun),C(n)},add:function(e,t){var n=Object(f.a)({},t.payload),r=Object(de.a)(e.recipe);return"bun"===n.type&&e.bun?r.splice(r.findIndex((function(e){return"bun"===e.type})),1,n):r.push(n),C(r)},sort:function(e,t){var n=t.payload;e.filling=n}}}),pe=function(e){return function(){var t=Object(k.a)(I.a.mark((function t(n,r){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({type:"burger/add",payload:e});case 2:V(n,r);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},be=fe.actions,me=fe.reducer,xe=(be.clear,be.random,be.del,be.add,c.a.memo((function(){var e=s((function(e){return e.burger.filling})),t=u(),n=Object(r.useCallback)((function(n,r){var c=e[n];t({type:"burger/sort",payload:le()(e,{$splice:[[n,1],[r,0,c]]})})}),[e,t]);return Object(b.jsx)("div",{className:oe.a.filling,id:"filling",children:Object(b.jsx)(re,{top:40,id:"burgers",children:Object(b.jsx)("div",{className:oe.a.recipe,children:e.map((function(e,r){return Object(b.jsxs)(se,{index:r,id:e.unicId,moveElement:n,children:[Object(b.jsx)(g.DragIcon,{type:"primary"}),Object(b.jsx)(g.ConstructorElement,{text:e.name,price:e.price,thumbnail:e.image,handleClose:function(){return t((n=e,function(e,t){e({type:"burger/del",payload:n.unicId}),V(e,t)}));var n}})]},e.unicId)}))})})})}))),he=Object(N.b)({name:"orders",initialState:{items:[],isLoading:!1,isError:!1,openDetails:!1,currentNumber:null},reducers:{closeDetails:function(e){e.openDetails=!1,e.currentNumber=null},orderLoading:function(e){e.openDetails=!0,e.isLoading=!0,e.isError=!1},orderError:function(e){e.isLoading=!1,e.isError=!0},orderSuccess:function(e,t){e.items=[].concat(Object(de.a)(e.items),[t.payload]),e.currentNumber=t.payload.number,e.isLoading=!1,e.isError=!1}}}),Oe=he.actions,ge=he.reducer,_e=Oe.orderLoading,ye=Oe.orderError,ve=Oe.orderSuccess;Oe.closeDetails;function Ne(e){return function(t,n){t(_e());var r,c=n().burger,a=c.totalPrice,o=c.recipe;(r=e,fetch("".concat(P,"/orders"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+S("accessToken")},body:JSON.stringify({ingredients:r})}).then((function(e){return F(e)}))).then((function(e){return t(ve(Object(f.a)(Object(f.a)({},e),{},{number:e.order.number,totalPrice:a,recipe:o})))})).catch((function(e){console.log("Error with order:",e),t(ye())}))}}var we=function(){var e=u(),t=Object(l.g)(),n=s((function(e){return e.burger})),c=s((function(e){return e.profile.user.isAuth}));Object(r.useEffect)((function(){!function(){var e=document.querySelector("#orderPrice"),t=null!==e?e.querySelector("svg"):null,n=null!==e?getComputedStyle(e).fontSize:"16px";null!==t&&(t.setAttribute("width",n),t.setAttribute("height",n))}()}),[]);var a=Object(r.useCallback)((function(){c?e(Ne(n.recipe.map((function(e){return e._id})))):t.push("/login")}),[e,n.recipe]);return Object(b.jsxs)("div",{className:oe.a.confirm,children:[Object(b.jsxs)("div",{className:oe.a.orderPrice+" text text_type_main-large",id:"orderPrice",children:[Object(b.jsx)("span",{className:"m-3",style:{lineHeight:"1"},children:n.totalPrice}),Object(b.jsx)(g.CurrencyIcon,{type:"primary"})]}),Object(b.jsx)(g.Button,{type:"primary",size:"large",onClick:a,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})},Ie=function(){var e=u();return Object(b.jsxs)("div",{className:oe.a.menu,children:[Object(b.jsx)(g.Button,{type:"primary",size:"small",onClick:function(){return e(function(){var e=Object(k.a)(I.a.mark((function e(t,n){var r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n().foods.items,e.next=3,t({type:"burger/random",payload:r});case 3:V(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},children:"\u0420\u0435\u0446\u0435\u043f\u0442 \u043e\u0442 \u043d\u0430\u0448\u0435\u0433\u043e \u0440\u043e\u0431\u043e\u0442\u0430"}),Object(b.jsx)(g.Button,{type:"primary",size:"small",onClick:function(){return e((function(e){e({type:"burger/clear"}),e({type:"foods/clearCounts"})}))},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0440\u0435\u0446\u0435\u043f\u0442"})]})},ke=n(57),Ee=n.n(ke),Ce=n(103),Se=n.n(Ce),Le=function(e){return Object(b.jsx)("div",{className:Se.a.overlay,onClick:e.onClose,children:e.children})},Te=document.getElementById("modal"),Pe=c.a.memo((function(e){var t=e.children,n=e.isLoading,c=e.onClose,a=e.title;Object(r.useEffect)((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[n]);var i=function(e){"Escape"!==e.key||n||c()};return o.a.createPortal(Object(b.jsx)(Le,{onClose:n?null:c,children:Object(b.jsxs)("div",{className:Ee.a.modalBox,onClick:function(e){return e.stopPropagation()},children:[!n&&Object(b.jsx)("button",{className:Ee.a.closePosition,children:Object(b.jsx)(g.CloseIcon,{onClick:c,type:"primary"})}),a&&Object(b.jsx)("p",{className:"text text_type_main-large",children:a}),Object(b.jsx)("div",{className:Ee.a.content,children:t})]})}),Te)})),Fe=n(39),Be=n.n(Fe),De=n.p+"static/media/icon-done.e036971b.png",Ae=function(){var e=function(){return E(1e3,9999)},t=Object(r.useState)(e),n=Object(K.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){var t=setInterval((function(){return a(e)}),50);return function(){clearInterval(t)}}),[]),Object(b.jsx)("h1",{className:Be.a.titleLoader+" text text_type_digits-large",children:c})},He=n(58),Re=n.n(He),Me=c.a.memo((function(e){var t=e.text,n=void 0===t?"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c...":t,r=[1,2,3,4,5];return Object(b.jsxs)("div",{className:Re.a.container,children:[Object(b.jsx)("div",{className:Re.a.icons,children:r.map((function(e){return Object(b.jsx)("div",{className:Re.a.icon,style:{top:70*Math.sin(2*e*Math.PI/r.length)+"px",left:70*Math.cos(2*e*Math.PI/r.length)+"px"},children:Object(b.jsx)(g.BurgerIcon,{type:"primary"})},e+"loader")}))}),Object(b.jsx)("p",{className:"text text_type_main-medium",children:n})]})})),ze=n(79),Je=n.n(ze),Ue=c.a.memo((function(e){var t=e.textArr,n=t||["\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a.","\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."];return Object(b.jsxs)("div",{className:Je.a.container,children:[Object(b.jsxs)("div",{className:Je.a.icons,children:[Object(b.jsx)(g.BurgerIcon,{type:"error"}),Object(b.jsx)(g.BurgerIcon,{type:"error"}),Object(b.jsx)(g.BurgerIcon,{type:"error"})]}),n.map((function(e,t){return Object(b.jsx)("p",{className:"text text_type_main-medium m-4",children:e},t+e)}))]})})),Ge=c.a.memo((function(e){var t=e.orders;return Object(b.jsx)("div",{className:Be.a.container,children:t.isError?Object(b.jsx)(Ue,{textArr:["\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u0437\u0430\u043a\u0430\u0437 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u043d\u044f\u0442\u044c","\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0435\u0433\u043e \u0435\u0449\u0435 \u0440\u0430\u0437"]}):Object(b.jsxs)(b.Fragment,{children:[t.isLoading?Object(b.jsx)(Ae,{}):Object(b.jsx)("h1",{className:Be.a.title+" text text_type_digits-large",children:t.currentNumber}),Object(b.jsx)("p",{className:"text text_type_main-medium",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),t.isLoading?Object(b.jsx)(Me,{text:""}):Object(b.jsx)("img",{className:Be.a.icon,src:De,alt:"icon_done"}),Object(b.jsx)("p",{className:"text text_type_main-default mb-2",children:t.isLoading?"\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u044e":"\u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(b.jsx)("span",{className:"text text_type_main-default text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})})})),Ve=function(){var e=s((function(e){return e.burger})),t=s((function(e){return e.orders})),n=u(),r=Object(ie.a)({accept:"food",drop:function(e){return function(e){n(pe(e))}(e)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),c=Object(K.a)(r,2),a=c[0],o=a.canDrop,i=a.isOver,l=c[1];return Object(b.jsxs)("article",{className:oe.a.main,children:[Object(b.jsx)(Ie,{}),Object(b.jsxs)("div",{className:oe.a.dropContainer,id:"dropContainer",ref:l,drop:String(i&&o),drag:String(!i&&o),children:[!!e.bun&&Object(b.jsx)(g.ConstructorElement,{type:"top",isLocked:!0,text:e.bun.name+" (\u0432\u0435\u0440\u0445)",price:e.bun.price,thumbnail:e.bun.image}),!!e.filling.length&&Object(b.jsx)(xe,{isDrag:i&&o,canDrop:o}),!!e.bun&&Object(b.jsx)(g.ConstructorElement,{type:"bottom",isLocked:!0,text:e.bun.name+" (\u043d\u0438\u0437)",price:e.bun.price,thumbnail:e.bun.image})]}),!!e.bun&&!!e.filling.length&&Object(b.jsx)(we,{}),Object(b.jsx)("div",{style:{overflow:"hidden"},children:t.openDetails&&Object(b.jsx)(Pe,{onClose:function(){n({type:"orders/closeDetails"}),n((function(e){e({type:"burger/clear"}),e({type:"foods/clearCounts"})}))},isLoading:t.isLoading,children:Object(b.jsx)(Ge,{orders:t})})})]})},Qe=n(201),Ye=n(108),We=function(){var e=s((function(e){return e.foods})),t=e.isLoading,n=e.isError,r=e.isLoaded;return Object(b.jsxs)(b.Fragment,{children:[r&&Object(b.jsx)(Qe.a,{backend:Ye.a,children:Object(b.jsxs)("div",{className:Y.a.content,children:[Object(b.jsx)(ce,{}),Object(b.jsx)(Ve,{})]})}),t&&Object(b.jsx)(Me,{text:"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u043c\u0435\u043d\u044e"}),n&&Object(b.jsx)(Ue,{})]})},Ze=n(33),qe=n.n(Ze),Ke=function(e){var t=e.footerLinks;return Object(b.jsx)("div",{className:qe.a.footer,children:t.map((function(e,t){return Object(b.jsxs)("div",{className:qe.a.footerBlock,children:[Object(b.jsx)("span",{className:"text text_type_main-default ".concat(qe.a.footerDesc),children:e.desc}),"\xa0\xa0",Object(b.jsx)(_.b,{to:e.pathname,children:Object(b.jsxs)("span",{className:"text text_type_main-default ".concat(qe.a.footerLink),children:[" ",e.text," "]})})]},t)}))})},Xe=function(e){var t=e.data,n=u(),c=t.title,a=t.arrInputs,o=t.footerLinks,i=t.confirm,l=s((function(e){return e.authForm.arrInputs}));Object(r.useEffect)((function(){n({type:"auth/setInputs",payload:a})}),[]);return Object(b.jsxs)("form",{className:qe.a.form,onSubmit:function(e){return function(e){e.preventDefault(),i.callback()}(e)},children:[!!c&&Object(b.jsx)("h2",{className:"text text_type_main-medium",children:c}),l.map((function(e){return Object(b.jsx)(g.Input,{type:e.type,name:e.name,value:e.value,icon:"password"===e.type?"HideIcon":e.icon,placeholder:e.placeholder,onChange:function(t){return n({type:"auth/handleInput",payload:{name:e.name,value:t.target.value}})},onIconClick:function(){return n({type:"auth/handleIcon",payload:e})}},e.name)})),Object(b.jsx)(g.Button,{children:i.text?i.text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),!!o&&Object(b.jsx)(Ke,{footerLinks:o})]})},$e=n(37),et={user:{email:"",name:"",isAuth:!1,canRestorePass:!1},form:{inputs:{name:"",email:"",password:""}},profileIsLoading:!1,porfileIsLoaded:!1,profileIsError:!1},tt=Object(N.b)({name:"profile",initialState:et,reducers:{profileLoading:function(e){e.profileIsLoading=!0,e.profileIsError=!1,e.porfileIsLoaded=!1},profileIsError:function(e){e.profileIsLoading=!1,e.profileIsError=!0,e.porfileIsLoaded=!1},profileSuccess:function(e,t){e.profileIsLoading=!1,e.profileIsError=!1,e.porfileIsLoaded=!0},setProfile:function(e,t){e.user=Object(f.a)(Object(f.a)({},t.payload),{},{isAuth:!0}),e.form.inputs.email=t.payload.email,e.form.inputs.name=t.payload.name},clearProfile:function(e){return et},onChangeInput:function(e,t){var n=t.payload,r=n.key,c=n.value;e.form.inputs=Object(f.a)(Object(f.a)({},e.form.inputs),{},Object($e.a)({},r,c))},toggleRestorePass:function(e){e.user=Object(f.a)(Object(f.a)({},e.user),{},{canRestorePass:!e.user.canRestorePass})}}}),nt=function(){return function(e){B().then((function(){return function(){var e=S("accessToken");return e?fetch("".concat(P,"/auth/user"),{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+e}}).then((function(e){return F(e)})):Promise.reject("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0435\u043d: \u043d\u0435\u0442 \u0442\u043e\u043a\u0435\u043d\u0430")}()})).then((function(t){return e(dt(t.user))})).then((function(){return e({type:"wsOrders/wsInit"})})).catch((function(t){console.log("Err with get User",t),e(ft())}))}},rt=function(){return function(e,t){var n=t().authForm.data;e({type:"profile/profileLoading"}),function(e){return fetch("".concat(P,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return F(e)}))}(n).then((function(t){var n={name:t.user.name,email:t.user.email};localStorage.setItem("refreshToken",t.refreshToken),L("accessToken",t.accessToken.split("Bearer ")[1]),Object(i.b)((function(){e({type:"profile/setProfile",payload:n}),e({type:"profile/profileSuccess"}),e({type:"auth/clearForm"})}))})).catch((function(t){console.log("Error with login",t),e({type:"profile/profileIsError"})}))}},ct=function(){return function(e,t){var n=t().authForm.data;e({type:"profile/profileLoading"}),function(e){return fetch("".concat(P,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return F(e)}))}(n).then((function(t){var n={name:t.user.name,email:t.user.email};Object(i.b)((function(){e({type:"profile/setProfile",payload:n}),e({type:"profile/profileSuccess"}),e({type:"auth/clearForm"})})),localStorage.setItem("refreshToken",t.refreshToken),L("accessToken",t.accessToken.split("Bearer ")[1])})).catch((function(t){console.log("Error with register",t),e({type:"profile/profileIsError"})}))}},at=function(){return function(e){(function(){var e=localStorage.getItem("refreshToken");return fetch("".concat(P,"/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:e},body:JSON.stringify({token:e})}).then((function(e){return F(e)}))})().then((function(){e(jt()),localStorage.removeItem("refreshToken"),L("accessToken",null)})).catch((function(e){console.log("Err with logout User",e)}))}},ot=function(e){return function(t){B().then((function(){return function(e){fetch("".concat(P,"/auth/user"),{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+S("accessToken")},body:JSON.stringify(e)}).then((function(e){return F(e)}))}(e)})).then((function(e){return t(dt(e.user))})).catch((function(e){console.log("Err with update User",e),t(ft())}))}},it=function(){return function(e,t){(function(e){return fetch("".concat(P,"/password-reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return F(e)}))})(t().authForm.data).then((function(t){console.log("RESULT of resetPass",t),e(bt())})).catch((function(e){return console.log("Error with reset pass",e)}))}},st=function(){return function(e,t){var n=t().authForm.data;(function(e){return fetch("".concat(P,"/password-reset/reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return F(e)}))})({password:n.password,token:n.token}).then((function(){return e(bt())})).catch((function(e){return console.log("Error with set new pass",e)}))}},ut=tt.reducer,lt=tt.actions,dt=lt.setProfile,jt=lt.clearProfile,ft=(lt.profileLoading,lt.profileSuccess,lt.profileIsError),pt=lt.onChangeInput,bt=lt.toggleRestorePass,mt=function(){var e,t=Object(l.h)(),n=s((function(e){return e.profile.user.isAuth})),r=u(),c={callback:function(){return r(rt())},text:"\u0412\u043e\u0439\u0442\u0438"};return n?Object(b.jsx)(l.a,{to:(null===(e=t.state)||void 0===e?void 0:e.from)||"/"}):Object(b.jsx)(Xe,{data:{title:"\u0412\u0445\u043e\u0434",arrInputs:[{name:"email",type:"email",placeholder:"E-mail",value:""},{name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:""}],footerLinks:[{desc:"\u0412\u044b - \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",text:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",pathname:"/register"},{desc:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",pathname:"/forgot-password"}],confirm:c}})},xt=function(){var e={callback:function(){return t(ct())},text:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"},t=u();return s((function(e){return e.profile.user.isAuth}))?Object(b.jsx)(l.a,{to:"/"}):Object(b.jsx)(Xe,{data:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",arrInputs:[{name:"name",type:"text",placeholder:"\u0418\u043c\u044f",value:""},{name:"email",type:"email",placeholder:"E-mail",value:""},{name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:""}],footerLinks:[{desc:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:e}})},ht=function(){var e=u(),t={callback:function(){return e(it())},text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"},n=s((function(e){return e.profile.user})),r=n.isAuth,c=n.canRestorePass;return console.log("canRestorePass=",c),r?Object(b.jsx)(l.a,{to:"/"}):c?Object(b.jsx)(l.a,{to:"/reset-password"}):Object(b.jsx)(Xe,{data:{title:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f",arrInputs:[{name:"email",type:"email",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",value:""}],footerLinks:[{desc:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:t}})},Ot=function(){var e=u(),t={callback:function(){return e(st())},text:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"},n=s((function(e){return e.profile.user})),r=n.isAuth,c=n.canRestorePass;return r?Object(b.jsx)(l.a,{to:"/"}):c?Object(b.jsx)(Xe,{data:{title:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f",arrInputs:[{name:"password",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",value:""},{name:"token",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",value:""}],footerLinks:[{desc:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",text:"\u0412\u043e\u0439\u0442\u0438",pathname:"/login"}],confirm:t}}):Object(b.jsx)(l.a,{to:"/login"})},gt=function(){return Object(b.jsx)("h1",{className:Y.a.noPage+" text text_type_main-large",children:"\u0412 \u044d\u0442\u043e\u0439 \u0412\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0442\u0430\u043a\u043e\u0439 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u043f\u043e\u043a\u0430"})},_t=function(){return Object(b.jsx)("h1",{className:Y.a.noOrderPage+" text text_type_main-medium",children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0443\u043a\u0430\u0437\u0430\u043d"})},yt=function(){return Object(b.jsx)("h1",{className:Y.a.noOrderPage+" text text_type_main-medium",children:"\u041d\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0437\u0430\u043a\u0430\u0437\u044b \u0435\u0449\u0451"})},vt=n(27),Nt=n.n(vt),wt=c.a.memo((function(e){var t=e.ingredient,n=e.children;return Object(b.jsxs)("div",{className:Nt.a.container,children:[Object(b.jsx)("img",{className:Nt.a.image,src:t.image_large,alt:t.name}),Object(b.jsx)("h3",{className:"text text_type_main-medium mb-4 mt-4",children:t.name}),Object(b.jsxs)("div",{className:Nt.a.composition+" mt-4 mb-8",children:[Object(b.jsxs)("div",{className:Nt.a.composeItem,children:[Object(b.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u041a\u0430\u043b"}),Object(b.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.calories})]}),Object(b.jsxs)("div",{className:Nt.a.composeItem,children:[Object(b.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(b.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.proteins})]}),Object(b.jsxs)("div",{className:Nt.a.composeItem,children:[Object(b.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(b.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.fat})]}),Object(b.jsxs)("div",{className:Nt.a.composeItem,children:[Object(b.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(b.jsx)("span",{className:"text text_type_digits-default text_color_inactive mb-2",children:t.carbohydrates})]})]}),!!n&&n]})})),It=c.a.memo((function(e){var t=e.ingredient,n=s((function(e){return e.burger.bun})),r=u(),c=Object(l.g)();return Object(b.jsx)(wt,{ingredient:t,children:("bun"!==t.type||JSON.stringify(t)!==JSON.stringify(n))&&Object(b.jsx)(g.Button,{type:"primary",size:"medium",onClick:function(){r(pe(t)),r({type:"ingredient/closeIngredient"}),c.push("/")},children:"bun"===t.type&&n?"\u0417\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u0443\u043b\u043a\u0443 \u0432 \u0431\u0443\u0440\u0433\u0435\u0440\u0435":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a \u0431\u0443\u0440\u0433\u0435\u0440\u0443"})})})),kt=function(){var e=s((function(e){return e.ingredient})),t=u(),n=Object(l.g)();return Object(b.jsx)("div",{style:{position:"fixed",overflow:"hidden"},children:e.show&&Object(b.jsx)(Pe,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",onClose:function(){t({type:"ingredient/closeIngredient"}),n.push("/")},children:Object(b.jsx)(It,{ingredient:e.item})})})},Et=function(){var e=Object(l.i)().id,t=s((function(e){return e.foods})),n=t.isLoading,c=t.isError,a=t.isLoaded,o=t.items,i=Object(r.useState)(),u=Object(K.a)(i,2),d=u[0],j=u[1];return Object(r.useEffect)((function(){if(o.length){var t=o.find((function(t){return t._id===e}));t&&j(t)}}),[a,o,e]),Object(b.jsxs)("div",{className:Y.a.modalPage,children:[a&&Object(b.jsx)(b.Fragment,{children:d?Object(b.jsx)(wt,{ingredient:d}):Object(b.jsx)(gt,{})}),n&&Object(b.jsx)(Me,{text:"\u0418\u0449\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(b.jsx)(Ue,{})]})},Ct=n(34),St=n.n(Ct),Lt=n(104),Tt=n.n(Lt),Pt=n(23),Ft=n.n(Pt),Bt=c.a.memo((function(e){var t=e.burger,n=Object(l.h)(),r=u(),c=t._id,a=t.number,o=t.name,i=t.ingredients,s=t.total,d=t.createdAt;return Object(b.jsx)(_.b,{to:{pathname:"".concat(n.pathname,"/").concat(c),state:{background:n}},children:Object(b.jsxs)("div",{className:Ft.a.card,onClick:function(){return r({type:"burgerOrder/openOrder",payload:t})},children:[Object(b.jsxs)("div",{className:Ft.a.cardHeader,children:[Object(b.jsx)(Mt,{number:a}),Object(b.jsx)(At,{time:d})]}),Object(b.jsx)("p",{className:"text text_type_main-medium",children:o}),Object(b.jsxs)("div",{className:Ft.a.cardFooter,children:[Object(b.jsx)(Dt,{images:i.map((function(e){return e.image}))}),Object(b.jsx)(Rt,{total:s})]})]})})})),Dt=function(e){var t=e.images,n=t.length>6,r=Object(de.a)(t).reverse();return Object(b.jsx)("div",{className:Ft.a.cardImages,children:r.map((function(e,t){return t<6&&Object(b.jsx)(Ht,{image:e,text:0===t&&n?"+"+(r.length-5):"",type:"row"},t)}))})},At=function(e){var t=e.time;return Object(b.jsx)("p",{className:"text text_type_main-default",style:{color:"var(--text-secondary-color)"},children:function(){var e=new Date(t),n=e.getDate(),r=e.getMonth(),c=e.getFullYear(),a=(new Date).getDate(),o=new Date(c,r+1,0).getDate(),i=a>=n?a-n:o+a-n,s=0===i?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f ":1===i?"\u0412\u0447\u0435\u0440\u0430 ":i%10===2||i%10===3||i%10===4?String(i)+" \u0434\u043d\u044f \u043d\u0430\u0437\u0430\u0434 ":i%10===1?String(i)+" \u0434\u0435\u043d\u044c \u043d\u0430\u0437\u0430\u0434":String(i)+" \u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434 ",u=" i-GMT"+e.toTimeString().substring(12,18).replaceAll("0","");return s+e.getHours()+":"+e.getMinutes()+u}()})},Ht=function(e){var t=e.image,n=e.text,r=e.type;return Object(b.jsx)("div",{className:Ft.a.imageContainer,style:"row"===r?{marginRight:"-16px"}:{},children:Object(b.jsx)("div",{className:n?Ft.a.cardImageBlur:Ft.a.cardImage,style:{backgroundImage:"url("+t+")"},children:!!n&&Object(b.jsx)("span",{className:"text text_type_digits-default",style:{zIndex:100},children:n})})})},Rt=function(e){var t=e.total;return Object(b.jsxs)("div",{className:Ft.a.cardTotal,children:[Object(b.jsx)("span",{className:"text text_type_digits-default mr-2",children:t}),Object(b.jsx)(g.CurrencyIcon,{type:"primary"})]})},Mt=function(e){var t=e.number;return Object(b.jsxs)("p",{className:"text text_type_digits-default",children:["#",t]})},zt=function(e){var t=e.title,n=e.burgers;return Object(b.jsxs)("article",{className:Tt.a.burgers,children:[!!t&&Object(b.jsx)("h1",{className:"text text_type_main-large mb-3 mt-10",children:t}),Object(b.jsx)(re,{bottom:16,id:"feed",children:Object(b.jsx)("div",{children:n.map((function(e){return Object(b.jsx)(Bt,{burger:e},e._id)}))})})]})},Jt=function(){var e=Object(l.j)().path;return Object(b.jsxs)("div",{className:St.a.profile,children:[Object(b.jsx)(Ut,{}),Object(b.jsxs)(l.d,{children:[Object(b.jsx)(l.b,{path:"".concat(e),exact:!0,children:Object(b.jsx)(Gt,{})}),Object(b.jsx)(l.b,{path:"".concat(e,"/orders"),exact:!0,children:Object(b.jsx)(Vt,{})}),Object(b.jsx)(l.b,{path:"".concat(e,"/orders/:id"),exact:!0,children:Object(b.jsx)(cn,{type:"profile"})}),Object(b.jsx)(l.b,{children:Object(b.jsx)(l.a,{to:"".concat(e)})})]})]})},Ut=function(){var e=Object(l.j)().url,t=u(),n="text text_type_main-medium ".concat(St.a.link),r="text text_type_main-medium ".concat(St.a.activeLink);return Object(b.jsxs)("div",{className:St.a.menu,children:[Object(b.jsx)(_.c,{exact:!0,to:"".concat(e),className:n,activeClassName:r,children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(b.jsx)(_.c,{to:"".concat(e,"/orders"),className:n,activeClassName:r,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(b.jsx)("span",{className:n,onClick:function(){return t(at())},children:"\u0412\u044b\u0445\u043e\u0434"})]})},Gt=function(){var e=s((function(e){return e.profile.form})),t=u();return Object(b.jsxs)("form",{className:St.a.form,onSubmit:function(n){return function(n){n.preventDefault(),t(ot(e.inputs))}(n)},id:"profileForm",children:[Object(b.jsx)(g.Input,{type:"text",value:e.inputs.name,placeholder:"\u0418\u043c\u044f",icon:"EditIcon",onChange:function(e){return t(pt({key:"name",value:e.target.value}))}}),Object(b.jsx)(g.Input,{type:"email",value:e.inputs.email,placeholder:"E-mail",icon:"EditIcon",onChange:function(e){return t(pt({key:"email",value:e.target.value}))}}),Object(b.jsx)(g.Input,{type:"password",value:e.inputs.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",icon:"EditIcon",onChange:function(e){return t(pt({key:"password",value:e.target.value}))}}),Object(b.jsx)("div",{className:St.a.formSubmit,children:Object(b.jsx)(g.Button,{children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]})},Vt=function(){var e=s((function(e){return e.wsOrders})),t=e.orders,n=e.success,c=e.isError,a=s((function(e){return e.foods.isLoaded})),o=u();return Object(r.useEffect)((function(){a&&!n&&o({type:"wsOrders/wsInit"})}),[a,n,o]),Object(r.useEffect)((function(){return function(){o({type:"wsOrders/wsClosed"})}}),[]),Object(b.jsxs)(b.Fragment,{children:[t&&n?t.length?Object(b.jsx)(zt,{burgers:t}):Object(b.jsx)(yt,{}):Object(b.jsx)(Me,{text:"\u0423\u0442\u043e\u0447\u043d\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(b.jsx)(Ue,{})]})},Qt=n(28),Yt=n.n(Qt),Wt=function(){var e=s((function(e){return e.wsFeed})),t=e.orders,n=e.total,c=e.totalToday,a=Object(r.useState)({arrDone:[],arrNotReady:[]}),o=Object(K.a)(a,2),i=o[0],u=o[1];return Object(r.useEffect)((function(){t&&t.length&&u({arrDone:t.filter((function(e){return"done"===e.status})).map((function(e){return e.number})),arrNotReady:t.filter((function(e){return"done"!==e.status})).map((function(e){return e.number}))})}),[t]),Object(b.jsxs)("article",{className:Yt.a.status,children:[Object(b.jsxs)("div",{className:Yt.a.data,children:[Object(b.jsx)(Zt,{title:"\u0413\u043e\u0442\u043e\u0432\u044b:",arr:i.arrDone,type:"primary"}),Object(b.jsx)(Zt,{title:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:",arr:i.arrNotReady,type:"secondary"})]}),Object(b.jsxs)("div",{className:Yt.a.total,children:[Object(b.jsx)(qt,{title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f:",count:n}),Object(b.jsx)(qt,{title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:",count:c})]})]})},Zt=c.a.memo((function(e){var t=e.arr,n=e.title,r=e.type;return Object(b.jsxs)("div",{className:Yt.a.columns,children:[Object(b.jsx)("h3",{className:"text text_type_main-medium mb-6",children:n}),Object(b.jsx)("div",{className:Yt.a.digits,children:t.map((function(e,t){return t<30&&Object(b.jsx)("p",{className:"text text_type_digits-default",style:{color:"var(--text-"+r+"-color)"},children:e},t)}))})]})})),qt=c.a.memo((function(e){var t=e.title,n=e.count,r=new Intl.NumberFormat("ru");return Object(b.jsxs)("div",{className:Yt.a.count,children:[Object(b.jsx)("h3",{className:"text text_type_main-medium",children:t}),Object(b.jsx)("p",{className:"text text_type_digits-large ".concat(Yt.a.totalDigits),children:r.format(n+0)})]})})),Kt=function(){var e=s((function(e){return e.wsFeed})),t=e.orders,n=e.success,c=e.isError,a=s((function(e){return e.foods.isLoaded})),o=u();return Object(r.useEffect)((function(){a&&!n&&o({type:"wsFeed/wsInit"})}),[a,n,o]),Object(r.useEffect)((function(){return function(){o({type:"wsFeed/wsClosed"})}}),[]),Object(b.jsxs)(b.Fragment,{children:[t&&n?Object(b.jsxs)("div",{className:Y.a.content,children:[Object(b.jsx)(zt,{burgers:t,title:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(b.jsx)(Wt,{})]}):Object(b.jsx)(Me,{text:"\u0423\u0442\u043e\u0447\u043d\u044f\u0435\u043c \u043d\u0430 \u043a\u0443\u0445\u043d\u0435"}),c&&Object(b.jsx)(Ue,{})]})},Xt=n(29),$t=n.n(Xt),en=function(e){var t=e.order,n=t.name,r=t.number,c=(t._id,t.status),a=t.ingredients,o=t.createdAt,i=t.total;return Object(b.jsxs)("div",{className:$t.a.order,children:[Object(b.jsx)("div",{className:$t.a.header,children:Object(b.jsx)(Mt,{number:r})}),Object(b.jsx)("h1",{className:"text text_type_main-medium",children:n}),Object(b.jsx)("span",{className:"text text_type_main-default mt-3 mb-10",style:{color:"var(--text-success-color"},children:"done"===c?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d":"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f"}),Object(b.jsx)(tn,{ingredients:a}),Object(b.jsxs)("div",{className:$t.a.footer,children:[Object(b.jsx)(At,{time:o}),Object(b.jsx)(Rt,{total:i})]})]})},tn=function(e){var t=e.ingredients;return Object(b.jsxs)("div",{className:$t.a.recipe,children:[Object(b.jsx)("h3",{className:"text text_type_main-medium mb-6 mt-5",children:"\u0421\u043e\u0441\u0442\u0430\u0432"}),Object(b.jsx)(re,{id:"recipe",children:Object(b.jsx)("div",{className:$t.a.ingredients,children:t.map((function(e,t){return Object(b.jsx)(nn,{ingredient:e},e._id+t)}))})})]})},nn=function(e){var t=e.ingredient,n="bun"===t.type?2:1*t.price;return Object(b.jsxs)("div",{className:$t.a.ingredient,children:[Object(b.jsxs)("div",{className:$t.a.about,children:[Object(b.jsx)(Ht,{image:t.image}),Object(b.jsx)("p",{className:"text text_type_main-default ml-4",children:t.name})]}),Object(b.jsx)(Rt,{total:n})]})},rn=function(){var e=s((function(e){return e.burgerOrder})),t=u(),n=Object(l.g)();return Object(b.jsx)("div",{style:{position:"fixed",overflow:"hidden"},children:e.show&&Object(b.jsx)(Pe,{onClose:function(){t({type:"burgerOrder/closeOrder"}),n.goBack()},children:Object(b.jsx)(en,{order:e.item})})})},cn=function(e){var t=e.type,n=Object(l.i)().id,c=s((function(e){return e.wsFeed})),a=c.orders,o=c.success,i=c.isError,d=s((function(e){return e.wsOrders.orders})),j=s((function(e){return e.foods.isLoaded})),f=u(),p=Object(r.useState)({order:null,isLoading:!0}),m=Object(K.a)(p,2),x=m[0],h=m[1];Object(r.useEffect)((function(){j&&!o&&f({type:"wsFeed/wsInit"})}),[j,o,f]),Object(r.useEffect)((function(){return function(){f({type:"wsFeed/wsClosed"})}}),[]),Object(r.useEffect)((function(){a&&"feed"===t&&h({order:a.find((function(e){return e._id===n})),isLoading:!1}),d&&"profile"===t&&h({order:d.find((function(e){return e._id===n})),isLoading:!1})}),[a,d,n,t]);var O=x.order,g=x.isLoading;return Object(b.jsxs)("div",{className:Y.a.modalPage,children:[!g&&Object(b.jsx)(b.Fragment,{children:O?Object(b.jsx)(en,{order:O}):Object(b.jsx)(_t,{})}),g&&Object(b.jsx)(Me,{text:"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0437\u0430\u043a\u0430\u0437"}),i&&Object(b.jsx)(Ue,{})]})},an=function(){var e=u(),t=Object(l.g)(),n=Object(l.h)();Object(r.useEffect)((function(){e(G()),e(nt())}),[]);var c=n.state&&"push"===t.action.toLowerCase()&&n.state.background;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(v,{}),Object(b.jsxs)("main",{className:j.a.main,children:[Object(b.jsxs)(l.d,{location:c||n,children:[Object(b.jsx)(x,{path:"/profile",children:Object(b.jsx)(Jt,{})}),Object(b.jsx)(l.b,{path:"/",exact:!0,children:Object(b.jsx)(We,{})}),Object(b.jsx)(l.b,{path:"/login",exact:!0,children:Object(b.jsx)(mt,{})}),Object(b.jsx)(l.b,{path:"/register",exact:!0,children:Object(b.jsx)(xt,{})}),Object(b.jsx)(l.b,{path:"/forgot-password",exact:!0,children:Object(b.jsx)(ht,{})}),Object(b.jsx)(l.b,{path:"/reset-password",exact:!0,children:Object(b.jsx)(Ot,{})}),Object(b.jsx)(l.b,{path:"/feed",exact:!0,children:Object(b.jsx)(Kt,{})}),Object(b.jsx)(l.b,{path:"/feed/:id",exact:!0,children:Object(b.jsx)(cn,{type:"feed"})}),Object(b.jsx)(l.b,{path:"/ingredients/:id",exact:!0,children:Object(b.jsx)(Et,{})}),Object(b.jsx)(l.b,{children:Object(b.jsx)(gt,{})})]}),c&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.b,{path:"/ingredients/:id",exact:!0,children:Object(b.jsx)(kt,{})}),Object(b.jsx)(l.b,{path:"/feed/:id",exact:!0,children:Object(b.jsx)(rn,{})}),Object(b.jsx)(x,{path:"/profile/orders/:id",exact:!0,children:Object(b.jsx)(rn,{})})]})]})]})},on=n(105),sn=n(106),un=n(110),ln=n(109),dn=function(e){Object(un.a)(n,e);var t=Object(ln.a)(n);function n(){var e;Object(on.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(sn.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log("Cath error",e,t)}},{key:"render",value:function(){return this.state.hasError?Object(b.jsx)(Ue,{}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.Component),jn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,204)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))},fn=n(107),pn=n.n(fn),bn=n(13),mn=Object(N.b)({name:"ingredient",initialState:{show:!1,item:null},reducers:{openIngredient:function(e,t){e.show=!0,e.item=t.payload},closeIngredient:function(e){e.show=!1,e.item=null}}}),xn=mn.actions,hn=mn.reducer,On=(xn.openIngredient,xn.closeIngredient,Object(N.b)({name:"header",initialState:{burger:{type:"secondary",icon:"burger",text:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440",link:"/"},orders:{type:"secondary",icon:"list",text:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432",link:"/feed"},profile:{type:"secondary",icon:"profile",text:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442",link:"/profile"}},reducers:{onChangeLink:function(e,t){for(var n in e)e[n]=n===t.payload?Object(f.a)(Object(f.a)({},e[n]),{},{type:"primary"}):Object(f.a)(Object(f.a)({},e[n]),{},{type:"secondary"})}}})),gn=On.actions,_n=On.reducer,yn=(gn.onChangeLink,{arrInputs:[],data:{}}),vn=Object(N.b)({name:"auth",initialState:yn,reducers:{setInputs:function(e,t){var n=t.payload;e.arrInputs=n.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{icon:"password"===e.type?"HideIcon":e.icon,valid:!1,error:""})}))},clearForm:function(e){return yn},handleInput:function(e,t){var n=t.payload,r=n.name,c=n.value;e.data=Object(f.a)(Object(f.a)({},e.data),{},Object($e.a)({},r,c)),e.arrInputs=e.arrInputs.map((function(e){return e.name===r?Object(f.a)(Object(f.a)({},e),{},{value:c}):e}))},handleIcon:function(e,t){var n=t.payload;"password"===n.name&&(e.arrInputs=e.arrInputs.map((function(e){return n.name===e.name?Object(f.a)(Object(f.a)({},n),{},{type:"password"===n.type?"text":"password",icon:"password"===n.type?"ShowIcon":"HideIcon"}):e})))}}}),Nn=vn.reducer,wn=vn.actions,In=(wn.setInputs,wn.clearForm,wn.handleInput,wn.handleIcon,Object(N.b)({name:"burgerOrder",initialState:{show:!1,item:null},reducers:{openOrder:function(e,t){e.show=!0,e.item=t.payload},closeOrder:function(e){e.show=!1,e.item=null}}})),kn=In.actions,En=In.reducer,Cn=(kn.openOrder,kn.closeOrder,Object(N.b)({name:"wsFeed",initialState:{success:!1,isError:!1,orders:null,total:0,totalToday:0},reducers:{wsError:function(e){e.success=!1,e.isError=!0},wsSuccess:function(e,t){e.success=!0},wsClosed:function(e,t){e.success=!1},wsGetFeed:function(e,t){var n=t.payload,r=n.parsedData,c=n.foods;e.success=!0,e.orders=T(r.orders,c),e.total=r.total,e.totalToday=r.totalToday}}})),Sn=Cn.reducer,Ln=Cn.actions,Tn=(Ln.wsError,Ln.wsSuccess,Ln.wsClosed,Ln.wsGetFeed,Object(N.b)({name:"wsOrders",initialState:{success:!1,isError:!1,orders:null},reducers:{wsError:function(e){e.success=!1,e.isError=!0},wsSuccess:function(e,t){e.success=!0},wsClosed:function(e,t){e.success=!1},wsGetOrders:function(e,t){var n=t.payload,r=n.parsedData,c=n.foods;e.success=!0,e.orders=T(r.orders,c)}}})),Pn=Tn.reducer,Fn=Tn.actions,Bn=(Fn.wsError,Fn.wsSuccess,Fn.wsClosed,Fn.wsGetOrders,Object(bn.b)({foods:R,burger:me,orders:ge,ingredient:hn,header:_n,profile:ut,authForm:Nn,burgerOrder:En,wsFeed:Sn,wsOrders:Pn})),Dn=(Object(f.a)(Object(f.a)(Object(f.a)({},On.actions),vn.actions),tt.actions),function(e,t,n){return function(r){var c=null;return function(a){return function(o){var i=r.dispatch,s=r.getState,u=o.type,l=t.wsInit,d=t.onOpen,j=t.onClose,f=t.onError,p=t.onMessage,b=s().foods.items;u===l&&(c=new WebSocket(n?e+"?token="+S("accessToken"):e)),c&&(c.onopen=function(e){i({type:d})},c.onerror=function(e){i({type:f})},c.onmessage=function(e){var t=e.data,n=JSON.parse(t);i({type:p,payload:{parsedData:n,foods:b}})},c.onclose=function(e){i({type:j})}),a(o)}}}}),An={wsInit:"wsFeed/wsInit",onOpen:"wsFeed/wsSuccess",onClose:"wsFeed/wsClosed",onError:"wsFeed/wsError",onMessage:"wsFeed/wsGetFeed"},Hn={wsInit:"wsOrders/wsInit",onOpen:"wsOrders/wsSuccess",onClose:"wsOrders/wsClosed",onError:"wsOrders/wsError",onMessage:"wsOrders/wsGetOrders"},Rn=Object(N.a)({reducer:Bn,middleware:function(e){return e().concat(pn.a,Dn("wss://norma.nomoreparties.space/orders/all",An,!1),Dn("wss://norma.nomoreparties.space/orders",Hn,!0))},devTools:!1});o.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(dn,{children:Object(b.jsx)(i.a,{store:Rn,children:Object(b.jsx)(_.a,{basename:"/burger",children:Object(b.jsx)(an,{})})})})}),document.getElementById("root")),jn()},20:function(e,t,n){e.exports={content:"pages_content__TpO_W",noPage:"pages_noPage__3xkgD",noOrderPage:"pages_noOrderPage__1hNU3 pages_noPage__3xkgD",modalPage:"pages_modalPage__UE8PE"}},22:function(e,t,n){e.exports={main:"burger-constructor_main__2tNbw",menu:"burger-constructor_menu__sONAg",dropContainer:"burger-constructor_dropContainer__Zjt8T",filling:"burger-constructor_filling__2fgAv",confirm:"burger-constructor_confirm__3NS70",orderPrice:"burger-constructor_orderPrice__3AlD8",recipe:"burger-constructor_recipe__3vUgp"}},23:function(e,t,n){e.exports={card:"burger-card_card__30_sB",cardHeader:"burger-card_cardHeader__3AvS1",cardFooter:"burger-card_cardFooter__2BWi2",cardTotal:"burger-card_cardTotal__3jUzz",cardImages:"burger-card_cardImages__3QA7Q",imageContainer:"burger-card_imageContainer__294ZG",cardImage:"burger-card_cardImage__3suQg",cardImageBlur:"burger-card_cardImageBlur__1wimx burger-card_cardImage__3suQg"}},27:function(e,t,n){e.exports={container:"ingredients-details_container__3uS5N",composition:"ingredients-details_composition__wYmpZ",composeItem:"ingredients-details_composeItem__1EVnk",image:"ingredients-details_image__3YRQs"}},28:function(e,t,n){e.exports={status:"feed-status_status__2TSop",data:"feed-status_data__Yyewg",columns:"feed-status_columns__3cz0E",digits:"feed-status_digits__1YHIi",total:"feed-status_total__3M4sv",totalDigits:"feed-status_totalDigits__F2CQl",count:"feed-status_count__CWVfR"}},29:function(e,t,n){e.exports={order:"burger-order_order__2SHCu",header:"burger-order_header__2tORc",footer:"burger-order_footer__3r0Bd",ingredients:"burger-order_ingredients__33wNb",ingredient:"burger-order_ingredient__192n2",about:"burger-order_about__2zK1n"}},32:function(e,t,n){e.exports={header:"app-header_header__1gtX5",content:"app-header_content__2DMzM",logo:"app-header_logo__2c-Yf","button-primary":"app-header_button-primary__3XgOa","button-secondary":"app-header_button-secondary__c8MyV app-header_button-primary__3XgOa",menu:"app-header_menu__2BfqR"}},33:function(e,t,n){e.exports={form:"form_form__1oY-K",footer:"form_footer__2aMqx",footerBlock:"form_footerBlock__1LJTT",footerDesc:"form_footerDesc__P6E6e",footerLink:"form_footerLink__1QOpS"}},34:function(e,t,n){e.exports={profile:"profile_profile___ZBKq",menu:"profile_menu__2zVJs",link:"profile_link__3eJaJ",activeLink:"profile_activeLink__1jnOS profile_link__3eJaJ",form:"profile_form__1oUU8",input_size_default:"profile_input_size_default__2VsF4",formSubmit:"profile_formSubmit__3F252"}},39:function(e,t,n){e.exports={container:"order-details_container__39iZT",icon:"order-details_icon__SQgvY",title:"order-details_title__37gWW",titleLoader:"order-details_titleLoader__36HNX"}},48:function(e,t,n){e.exports={container:"scrollbox_container__2Bl4W",scrollBarContainer:"scrollbox_scrollBarContainer__25fZX",content:"scrollbox_content__2y-GP",scrollbar:"scrollbox_scrollbar__3ORoV"}},57:function(e,t,n){e.exports={modalBox:"modal_modalBox__KI4un",closePosition:"modal_closePosition__1sEwP",content:"modal_content__3O20I"}},58:function(e,t,n){e.exports={container:"loader_container__1MVDK",icons:"loader_icons__3768C",rotateIcons:"loader_rotateIcons__2q2CU",icon:"loader_icon__1H6Wd",rotateIcon:"loader_rotateIcon__1sb08"}},79:function(e,t,n){e.exports={container:"error-message_container__1xeVZ",icons:"error-message_icons__3GgcV"}},99:function(e,t,n){e.exports={main:"app_main__3xsct"}}},[[196,1,2]]]);
//# sourceMappingURL=main.f3c2644a.chunk.js.map